[0m15:03:41.561936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB7CEA340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABA1D03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABA1D0190>]}


============================== 15:03:41.568936 | ad02c94e-08fb-470d-98f1-b877e3ecf81a ==============================
[0m15:03:41.568936 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:03:41.569939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:03:41.570936 [info ] [MainThread]: dbt version: 1.7.10
[0m15:03:41.571936 [info ] [MainThread]: python version: 3.9.13
[0m15:03:41.572938 [info ] [MainThread]: python path: C:\Users\cleme\dbt-env\Scripts\python.exe
[0m15:03:41.573937 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m15:03:41.682114 [info ] [MainThread]: Using profiles dir at C:\Users\cleme\.dbt
[0m15:03:41.683109 [info ] [MainThread]: Using profiles.yml file at C:\Users\cleme\.dbt\profiles.yml
[0m15:03:41.683109 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\cleme\TP_note_DBT\dbt_project.yml
[0m15:03:41.685741 [info ] [MainThread]: adapter type: postgres
[0m15:03:41.686751 [info ] [MainThread]: adapter version: 1.7.10
[0m15:03:41.772609 [info ] [MainThread]: Configuration:
[0m15:03:41.774615 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:03:41.774615 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:03:41.775667 [info ] [MainThread]: Required dependencies:
[0m15:03:41.776611 [debug] [MainThread]: Executing "git --help"
[0m15:03:41.797581 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:03:41.798579 [info ] [MainThread]: Connection:
[0m15:03:41.799511 [info ] [MainThread]:   host: 172.17.144.1
[0m15:03:41.800696 [info ] [MainThread]:   port: 5432
[0m15:03:41.801492 [info ] [MainThread]:   user: postgres
[0m15:03:41.801492 [info ] [MainThread]:   database: postgres
[0m15:03:41.802537 [info ] [MainThread]:   schema: public
[0m15:03:41.804096 [info ] [MainThread]:   connect_timeout: 10
[0m15:03:41.804096 [info ] [MainThread]:   role: None
[0m15:03:41.805250 [info ] [MainThread]:   search_path: None
[0m15:03:41.806260 [info ] [MainThread]:   keepalives_idle: 0
[0m15:03:41.806260 [info ] [MainThread]:   sslmode: None
[0m15:03:41.807261 [info ] [MainThread]:   sslcert: None
[0m15:03:41.808482 [info ] [MainThread]:   sslkey: None
[0m15:03:41.809489 [info ] [MainThread]:   sslrootcert: None
[0m15:03:41.809489 [info ] [MainThread]:   application_name: dbt
[0m15:03:41.810489 [info ] [MainThread]:   retries: 1
[0m15:03:41.811573 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:03:41.813579 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:03:41.814581 [debug] [MainThread]: Using postgres connection "debug"
[0m15:03:41.814581 [debug] [MainThread]: On debug: select 1 as id
[0m15:03:41.815580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:41.868773 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:03:41.870382 [debug] [MainThread]: On debug: Close
[0m15:03:41.870969 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:03:41.871474 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:03:41.871997 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m15:03:41.873579 [debug] [MainThread]: Command `dbt debug` failed at 15:03:41.873579 after 0.39 seconds
[0m15:03:41.874621 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:03:41.875138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAB7CEA340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABA53F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABA5B7B50>]}
[0m15:03:41.875656 [debug] [MainThread]: Flushing usage events
[0m15:07:14.051870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C701FEA880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7046B3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7046B3490>]}


============================== 15:07:14.059870 | c3df2a67-e56b-4f44-b712-68d52aec57a8 ==============================
[0m15:07:14.059870 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:07:14.060870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:07:14.062836 [info ] [MainThread]: dbt version: 1.7.10
[0m15:07:14.062836 [info ] [MainThread]: python version: 3.9.13
[0m15:07:14.064657 [info ] [MainThread]: python path: C:\Users\cleme\dbt-env\Scripts\python.exe
[0m15:07:14.065915 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m15:07:14.287506 [info ] [MainThread]: Using profiles dir at C:\Users\cleme\.dbt
[0m15:07:14.288508 [info ] [MainThread]: Using profiles.yml file at C:\Users\cleme\.dbt\profiles.yml
[0m15:07:14.289507 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\cleme\TP_note_DBT\dbt_project.yml
[0m15:07:14.291506 [info ] [MainThread]: adapter type: postgres
[0m15:07:14.292506 [info ] [MainThread]: adapter version: 1.7.10
[0m15:07:14.500990 [info ] [MainThread]: Configuration:
[0m15:07:14.506990 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:07:14.512989 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:07:14.513987 [info ] [MainThread]: Required dependencies:
[0m15:07:14.514986 [debug] [MainThread]: Executing "git --help"
[0m15:07:14.545724 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:07:14.546740 [info ] [MainThread]: Connection:
[0m15:07:14.547738 [info ] [MainThread]:   host: 172.17.144.1
[0m15:07:14.548738 [info ] [MainThread]:   port: 5432
[0m15:07:14.549740 [info ] [MainThread]:   user: postgres
[0m15:07:14.551739 [info ] [MainThread]:   database: postgres
[0m15:07:14.552740 [info ] [MainThread]:   schema: public
[0m15:07:14.553737 [info ] [MainThread]:   connect_timeout: 10
[0m15:07:14.554740 [info ] [MainThread]:   role: None
[0m15:07:14.555737 [info ] [MainThread]:   search_path: None
[0m15:07:14.556740 [info ] [MainThread]:   keepalives_idle: 0
[0m15:07:14.557737 [info ] [MainThread]:   sslmode: None
[0m15:07:14.558740 [info ] [MainThread]:   sslcert: None
[0m15:07:14.559738 [info ] [MainThread]:   sslkey: None
[0m15:07:14.560737 [info ] [MainThread]:   sslrootcert: None
[0m15:07:14.561738 [info ] [MainThread]:   application_name: dbt
[0m15:07:14.562738 [info ] [MainThread]:   retries: 1
[0m15:07:14.563739 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:07:14.565876 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:07:14.566914 [debug] [MainThread]: Using postgres connection "debug"
[0m15:07:14.567926 [debug] [MainThread]: On debug: select 1 as id
[0m15:07:14.568941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:14.607044 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:07:14.610330 [debug] [MainThread]: On debug: Close
[0m15:07:14.613075 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:07:14.615187 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:07:14.617824 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m15:07:14.622011 [debug] [MainThread]: Command `dbt debug` failed at 15:07:14.621008 after 0.68 seconds
[0m15:07:14.623007 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:07:14.625009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C701FEA880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7046EFF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7046CF910>]}
[0m15:07:14.627007 [debug] [MainThread]: Flushing usage events
[0m15:12:47.975381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C76A4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C9B74A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C9B74100>]}


============================== 15:12:47.984709 | 61fcb2a7-4e8d-41af-b3d1-a8b3ee2e3e15 ==============================
[0m15:12:47.984709 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:12:47.986089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:12:47.988443 [info ] [MainThread]: dbt version: 1.7.10
[0m15:12:47.989824 [info ] [MainThread]: python version: 3.9.13
[0m15:12:47.990851 [info ] [MainThread]: python path: C:\Users\cleme\dbt-env\Scripts\python.exe
[0m15:12:47.990851 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m15:12:48.120242 [info ] [MainThread]: Using profiles dir at C:\Users\cleme\.dbt
[0m15:12:48.121074 [info ] [MainThread]: Using profiles.yml file at C:\Users\cleme\.dbt\profiles.yml
[0m15:12:48.122066 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\cleme\TP_note_DBT\dbt_project.yml
[0m15:12:48.122863 [info ] [MainThread]: adapter type: postgres
[0m15:12:48.123870 [info ] [MainThread]: adapter version: 1.7.10
[0m15:12:48.252968 [info ] [MainThread]: Configuration:
[0m15:12:48.253964 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:12:48.254963 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:12:48.255962 [info ] [MainThread]: Required dependencies:
[0m15:12:48.257965 [debug] [MainThread]: Executing "git --help"
[0m15:12:48.339223 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:12:48.340212 [debug] [MainThread]: STDERR: "b''"
[0m15:12:48.340212 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:12:48.341218 [info ] [MainThread]: Connection:
[0m15:12:48.342218 [info ] [MainThread]:   host: 172.17.144.1
[0m15:12:48.343208 [info ] [MainThread]:   port: 5432
[0m15:12:48.344208 [info ] [MainThread]:   user: postgres
[0m15:12:48.345210 [info ] [MainThread]:   database: postgres
[0m15:12:48.345210 [info ] [MainThread]:   schema: public
[0m15:12:48.346207 [info ] [MainThread]:   connect_timeout: 10
[0m15:12:48.347211 [info ] [MainThread]:   role: None
[0m15:12:48.348209 [info ] [MainThread]:   search_path: None
[0m15:12:48.348209 [info ] [MainThread]:   keepalives_idle: 0
[0m15:12:48.349208 [info ] [MainThread]:   sslmode: None
[0m15:12:48.350207 [info ] [MainThread]:   sslcert: None
[0m15:12:48.350743 [info ] [MainThread]:   sslkey: None
[0m15:12:48.351749 [info ] [MainThread]:   sslrootcert: None
[0m15:12:48.352750 [info ] [MainThread]:   application_name: dbt
[0m15:12:48.352750 [info ] [MainThread]:   retries: 1
[0m15:12:48.353750 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:12:48.354749 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:12:48.355750 [debug] [MainThread]: Using postgres connection "debug"
[0m15:12:48.355750 [debug] [MainThread]: On debug: select 1 as id
[0m15:12:48.356750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:48.384343 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:12:48.385903 [debug] [MainThread]: On debug: Close
[0m15:12:48.386425 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:12:48.387483 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:12:48.390119 [debug] [MainThread]: Command `dbt debug` succeeded at 15:12:48.390119 after 0.54 seconds
[0m15:12:48.391169 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:12:48.392211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C76A4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C84E5F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C9EC5790>]}
[0m15:12:48.393258 [debug] [MainThread]: Flushing usage events
[0m15:23:16.697750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1052CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF12C14D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF12C142B0>]}


============================== 15:23:16.706018 | b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e ==============================
[0m15:23:16.706018 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:23:16.707502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:16.958997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF12D9DF40>]}
[0m15:23:17.059501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF12D8A940>]}
[0m15:23:17.061501 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:23:17.072950 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:23:17.073981 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:23:17.075020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF12F03E80>]}
[0m15:23:18.390252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1386E0D0>]}
[0m15:23:18.406345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF133EAF40>]}
[0m15:23:18.406345 [info ] [MainThread]: Found 2 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:23:18.407758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF134AE640>]}
[0m15:23:18.410281 [info ] [MainThread]: 
[0m15:23:18.410826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:18.415294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:23:18.428325 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:23:18.429322 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:23:18.430281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:18.471850 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:23:18.473939 [debug] [ThreadPool]: On list_postgres: Close
[0m15:23:18.477206 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m15:23:18.483952 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:23:18.484992 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:23:18.485513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:18.502140 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:18.503168 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:23:18.504217 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:23:18.520144 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:18.522235 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:23:18.523800 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:23:18.531171 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:18.531697 [debug] [MainThread]: On master: BEGIN
[0m15:23:18.532224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:18.547958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:18.549003 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:18.549521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:18.556800 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:18.558908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF13996820>]}
[0m15:23:18.559434 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:18.560875 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:18.561380 [debug] [MainThread]: On master: BEGIN
[0m15:23:18.563510 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:18.564556 [debug] [MainThread]: On master: COMMIT
[0m15:23:18.565085 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:18.565602 [debug] [MainThread]: On master: COMMIT
[0m15:23:18.567145 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:18.567661 [debug] [MainThread]: On master: Close
[0m15:23:18.568691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:18.569744 [info ] [MainThread]: 
[0m15:23:18.578641 [debug] [Thread-1  ]: Began running node seed.TP_note_DBT.raw_product_data
[0m15:23:18.579157 [info ] [Thread-1  ]: 1 of 2 START seed file public.raw_product_data ................................. [RUN]
[0m15:23:18.581305 [debug] [Thread-1  ]: Acquiring new postgres connection 'seed.TP_note_DBT.raw_product_data'
[0m15:23:18.581305 [debug] [Thread-1  ]: Began compiling node seed.TP_note_DBT.raw_product_data
[0m15:23:18.582304 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_product_data (compile): 15:23:18.582304 => 15:23:18.582304
[0m15:23:18.583304 [debug] [Thread-1  ]: Began executing node seed.TP_note_DBT.raw_product_data
[0m15:23:18.616480 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:23:18.617492 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: BEGIN
[0m15:23:18.618539 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:23:18.639953 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:23:18.641051 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:23:18.642108 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "seed.TP_note_DBT.raw_product_data"} */

    create table "postgres"."public"."raw_product_data" ("product_id" integer,"product_name" text,"category" text,"price" float8)
  
[0m15:23:18.660936 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m15:23:18.685991 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:23:18.686976 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: 
          insert into "postgres"."public"."raw_product_data" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m15:23:18.690972 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
[0m15:23:18.697239 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.TP_note_DBT.raw_product_data"
[0m15:23:18.718629 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: COMMIT
[0m15:23:18.719635 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:23:18.720635 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: COMMIT
[0m15:23:18.725223 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:23:18.726701 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_product_data (execute): 15:23:18.583304 => 15:23:18.726152
[0m15:23:18.727303 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: Close
[0m15:23:18.728361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF138932B0>]}
[0m15:23:18.729480 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file public.raw_product_data ............................. [[32mINSERT 4[0m in 0.15s]
[0m15:23:18.730524 [debug] [Thread-1  ]: Finished running node seed.TP_note_DBT.raw_product_data
[0m15:23:18.731576 [debug] [Thread-1  ]: Began running node seed.TP_note_DBT.raw_sales_data
[0m15:23:18.732099 [info ] [Thread-1  ]: 2 of 2 START seed file public.raw_sales_data ................................... [RUN]
[0m15:23:18.733738 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.TP_note_DBT.raw_product_data, now seed.TP_note_DBT.raw_sales_data)
[0m15:23:18.734260 [debug] [Thread-1  ]: Began compiling node seed.TP_note_DBT.raw_sales_data
[0m15:23:18.734780 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_sales_data (compile): 15:23:18.734780 => 15:23:18.734780
[0m15:23:18.735820 [debug] [Thread-1  ]: Began executing node seed.TP_note_DBT.raw_sales_data
[0m15:23:18.766703 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:23:18.767708 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: BEGIN
[0m15:23:18.768722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:18.785380 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:23:18.785906 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:23:18.786917 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "seed.TP_note_DBT.raw_sales_data"} */

    create table "postgres"."public"."raw_sales_data" ("sale_id" integer,"product_id" integer,"quantity" integer,"sale_date" date,"sale_amount" float8)
  
[0m15:23:18.790077 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m15:23:19.569841 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:23:19.570844 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: 
          insert into "postgres"."public"."raw_sales_data" ("sale_id", "product_id", "quantity", "sale_date", "sale_amount") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m15:23:19.579716 [debug] [Thread-1  ]: SQL status: INSERT 0 500 in 0.0 seconds
[0m15:23:19.581783 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.TP_note_DBT.raw_sales_data"
[0m15:23:19.585036 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: COMMIT
[0m15:23:19.585727 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:23:19.586807 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: COMMIT
[0m15:23:19.589411 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:23:19.590466 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_sales_data (execute): 15:23:18.735820 => 15:23:19.590466
[0m15:23:19.591472 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: Close
[0m15:23:19.593297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bb2e5d-43ea-4967-b2be-6ab2b3d87b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF13904DC0>]}
[0m15:23:19.594306 [info ] [Thread-1  ]: 2 of 2 OK loaded seed file public.raw_sales_data ............................... [[32mINSERT 500[0m in 0.86s]
[0m15:23:19.595686 [debug] [Thread-1  ]: Finished running node seed.TP_note_DBT.raw_sales_data
[0m15:23:19.597247 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:19.597769 [debug] [MainThread]: On master: BEGIN
[0m15:23:19.598287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:19.616419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:19.617454 [debug] [MainThread]: On master: COMMIT
[0m15:23:19.617973 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:19.618504 [debug] [MainThread]: On master: COMMIT
[0m15:23:19.620117 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:19.620646 [debug] [MainThread]: On master: Close
[0m15:23:19.621696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:19.622221 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:23:19.622742 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m15:23:19.623263 [debug] [MainThread]: Connection 'seed.TP_note_DBT.raw_sales_data' was properly closed.
[0m15:23:19.624320 [info ] [MainThread]: 
[0m15:23:19.624846 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m15:23:19.626428 [debug] [MainThread]: Command end result
[0m15:23:19.636829 [info ] [MainThread]: 
[0m15:23:19.637843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:19.638862 [info ] [MainThread]: 
[0m15:23:19.640127 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:23:19.642134 [debug] [MainThread]: Command `dbt seed` succeeded at 15:23:19.641134 after 3.03 seconds
[0m15:23:19.642134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1052CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF12DE2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF12D9D7F0>]}
[0m15:23:19.643135 [debug] [MainThread]: Flushing usage events
[0m15:42:45.014162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4176C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B44055D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B44055D30>]}


============================== 15:42:45.028394 | c22409dd-3fe2-4571-830c-52768f946d55 ==============================
[0m15:42:45.028394 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:42:45.029965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sales', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:45.521041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22409dd-3fe2-4571-830c-52768f946d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B441E0F40>]}
[0m15:42:45.650823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22409dd-3fe2-4571-830c-52768f946d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B441CA940>]}
[0m15:42:45.652823 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:42:45.667045 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:42:45.965775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:42:45.967775 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\example\stg_sales.sql
[0m15:42:46.214599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22409dd-3fe2-4571-830c-52768f946d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4487A0D0>]}
[0m15:42:46.235268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22409dd-3fe2-4571-830c-52768f946d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B446DAD60>]}
[0m15:42:46.236313 [info ] [MainThread]: Found 3 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:42:46.237279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22409dd-3fe2-4571-830c-52768f946d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B446DAE50>]}
[0m15:42:46.239893 [info ] [MainThread]: 
[0m15:42:46.242849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:46.245622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:42:46.262073 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:42:46.263937 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:42:46.264951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:46.314096 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:42:46.316772 [debug] [ThreadPool]: On list_postgres: Close
[0m15:42:46.320998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m15:42:46.332867 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:42:46.333867 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:42:46.334867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:46.361174 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:42:46.362760 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:42:46.364419 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:42:46.375143 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:42:46.377685 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:42:46.380851 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:42:46.391331 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.392396 [debug] [MainThread]: On master: BEGIN
[0m15:42:46.393471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:46.420750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:46.421835 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.422719 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:46.432170 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:42:46.434277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22409dd-3fe2-4571-830c-52768f946d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B446285B0>]}
[0m15:42:46.435332 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:46.438260 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.439338 [debug] [MainThread]: On master: BEGIN
[0m15:42:46.442707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:46.443763 [debug] [MainThread]: On master: COMMIT
[0m15:42:46.444862 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.445919 [debug] [MainThread]: On master: COMMIT
[0m15:42:46.448071 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:42:46.449625 [debug] [MainThread]: On master: Close
[0m15:42:46.451000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:46.452007 [info ] [MainThread]: 
[0m15:42:46.461072 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.stg_sales
[0m15:42:46.462667 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_sales ................................... [RUN]
[0m15:42:46.464935 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.stg_sales'
[0m15:42:46.466253 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.stg_sales
[0m15:42:46.479717 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.stg_sales"
[0m15:42:46.483314 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.stg_sales (compile): 15:42:46.466767 => 15:42:46.483314
[0m15:42:46.485313 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.stg_sales
[0m15:42:46.552939 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.stg_sales"
[0m15:42:46.557939 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_sales"
[0m15:42:46.558939 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_sales: BEGIN
[0m15:42:46.559937 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:42:46.585464 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:42:46.587034 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_sales"
[0m15:42:46.588117 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.stg_sales"} */

  create view "postgres"."public"."stg_sales__dbt_tmp"
    
    
  as (
    

select
    sale_id,
    product_id,
    quantity::integer as quantity,
    sale_date::date as sale_date
from "postgres"."public"."raw_sales_data"
  );
[0m15:42:46.596142 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:42:46.607686 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_sales"
[0m15:42:46.607686 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.stg_sales"} */
alter table "postgres"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m15:42:46.613245 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:46.639232 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_sales: COMMIT
[0m15:42:46.641268 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_sales"
[0m15:42:46.642273 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_sales: COMMIT
[0m15:42:46.647370 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:42:46.660630 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."stg_sales__dbt_backup"
[0m15:42:46.669629 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_sales"
[0m15:42:46.670629 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.stg_sales"} */
drop view if exists "postgres"."public"."stg_sales__dbt_backup" cascade
[0m15:42:46.675205 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m15:42:46.679133 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.stg_sales (execute): 15:42:46.485313 => 15:42:46.678504
[0m15:42:46.680266 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_sales: Close
[0m15:42:46.682959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22409dd-3fe2-4571-830c-52768f946d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B448B5820>]}
[0m15:42:46.684678 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.22s]
[0m15:42:46.686766 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.stg_sales
[0m15:42:46.690494 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.692018 [debug] [MainThread]: On master: BEGIN
[0m15:42:46.692018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:46.726311 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:46.727977 [debug] [MainThread]: On master: COMMIT
[0m15:42:46.729788 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.731278 [debug] [MainThread]: On master: COMMIT
[0m15:42:46.735423 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:42:46.737148 [debug] [MainThread]: On master: Close
[0m15:42:46.740548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:46.742126 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:42:46.744404 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m15:42:46.746067 [debug] [MainThread]: Connection 'model.TP_note_DBT.stg_sales' was properly closed.
[0m15:42:46.748301 [info ] [MainThread]: 
[0m15:42:46.750729 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m15:42:46.753836 [debug] [MainThread]: Command end result
[0m15:42:46.779854 [info ] [MainThread]: 
[0m15:42:46.783035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:46.786074 [info ] [MainThread]: 
[0m15:42:46.789200 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:46.794195 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:46.794195 after 1.95 seconds
[0m15:42:46.796215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4176C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B44055760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4487A460>]}
[0m15:42:46.798222 [debug] [MainThread]: Flushing usage events
[0m15:55:51.847144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194696CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021949013D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219490132B0>]}


============================== 15:55:51.856180 | ba0060ea-caed-42fc-aca5-4ed3c9518c62 ==============================
[0m15:55:51.856180 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:55:51.858164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m15:55:52.353748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219491A7F40>]}
[0m15:55:52.540493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194919A940>]}
[0m15:55:52.542455 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:55:52.557120 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:55:52.819284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:52.822286 [debug] [MainThread]: Partial parsing: updated file: TP_note_DBT://models\example\stg_sales.sql
[0m15:55:53.175429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219498240D0>]}
[0m15:55:53.211213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194963FA30>]}
[0m15:55:53.213212 [info ] [MainThread]: Found 3 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:55:53.215215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194963FC10>]}
[0m15:55:53.221205 [info ] [MainThread]: 
[0m15:55:53.225442 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:53.230329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:55:53.259224 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:55:53.261597 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:55:53.264332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:53.323250 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:55:53.327278 [debug] [ThreadPool]: On list_postgres: Close
[0m15:55:53.332226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m15:55:53.344239 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:55:53.345642 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:55:53.346655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:53.373310 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:55:53.375615 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:55:53.377318 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:55:53.386644 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:55:53.389523 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:55:53.392946 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:55:53.406516 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:53.407626 [debug] [MainThread]: On master: BEGIN
[0m15:55:53.408761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:53.435872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:55:53.437444 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:53.439059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:53.450023 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:55:53.453982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219492AC430>]}
[0m15:55:53.455761 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:53.459116 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:53.460808 [debug] [MainThread]: On master: BEGIN
[0m15:55:53.465839 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:55:53.467995 [debug] [MainThread]: On master: COMMIT
[0m15:55:53.469635 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:53.471412 [debug] [MainThread]: On master: COMMIT
[0m15:55:53.474718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:55:53.475809 [debug] [MainThread]: On master: Close
[0m15:55:53.478608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:53.480812 [info ] [MainThread]: 
[0m15:55:53.487988 [debug] [Thread-1  ]: Began running node seed.TP_note_DBT.raw_product_data
[0m15:55:53.490005 [info ] [Thread-1  ]: 1 of 2 START seed file public.raw_product_data ................................. [RUN]
[0m15:55:53.493001 [debug] [Thread-1  ]: Acquiring new postgres connection 'seed.TP_note_DBT.raw_product_data'
[0m15:55:53.494998 [debug] [Thread-1  ]: Began compiling node seed.TP_note_DBT.raw_product_data
[0m15:55:53.496000 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_product_data (compile): 15:55:53.496000 => 15:55:53.496000
[0m15:55:53.497999 [debug] [Thread-1  ]: Began executing node seed.TP_note_DBT.raw_product_data
[0m15:55:53.567792 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:55:53.569414 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: BEGIN
[0m15:55:53.570750 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:55:53.602783 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:55:53.604524 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:55:53.605592 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "seed.TP_note_DBT.raw_product_data"} */
truncate table "postgres"."public"."raw_product_data"
[0m15:55:53.616380 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:55:53.667402 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:55:53.668528 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: 
          insert into "postgres"."public"."raw_product_data" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m15:55:53.674038 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
[0m15:55:53.687267 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.TP_note_DBT.raw_product_data"
[0m15:55:53.719766 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: COMMIT
[0m15:55:53.720760 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_product_data"
[0m15:55:53.722720 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: COMMIT
[0m15:55:53.728810 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:55:53.730921 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_product_data (execute): 15:55:53.498998 => 15:55:53.730846
[0m15:55:53.732353 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_product_data: Close
[0m15:55:53.734135 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021949899D00>]}
[0m15:55:53.735800 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file public.raw_product_data ............................. [[32mINSERT 4[0m in 0.24s]
[0m15:55:53.738058 [debug] [Thread-1  ]: Finished running node seed.TP_note_DBT.raw_product_data
[0m15:55:53.739275 [debug] [Thread-1  ]: Began running node seed.TP_note_DBT.raw_sales_data
[0m15:55:53.740364 [info ] [Thread-1  ]: 2 of 2 START seed file public.raw_sales_data ................................... [RUN]
[0m15:55:53.743308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.TP_note_DBT.raw_product_data, now seed.TP_note_DBT.raw_sales_data)
[0m15:55:53.744541 [debug] [Thread-1  ]: Began compiling node seed.TP_note_DBT.raw_sales_data
[0m15:55:53.746250 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_sales_data (compile): 15:55:53.745636 => 15:55:53.745636
[0m15:55:53.747463 [debug] [Thread-1  ]: Began executing node seed.TP_note_DBT.raw_sales_data
[0m15:55:53.807470 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:55:53.808444 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: BEGIN
[0m15:55:53.810233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:55:53.836510 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:55:53.837584 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:55:53.838716 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "seed.TP_note_DBT.raw_sales_data"} */
truncate table "postgres"."public"."raw_sales_data"
[0m15:55:53.842185 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:55:55.572315 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:55:55.573315 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: 
          insert into "postgres"."public"."raw_sales_data" ("sale_id", "product_id", "quantity", "sale_date", "sale_amount") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m15:55:55.586894 [debug] [Thread-1  ]: SQL status: INSERT 0 500 in 0.0 seconds
[0m15:55:55.588694 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.TP_note_DBT.raw_sales_data"
[0m15:55:55.593496 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: COMMIT
[0m15:55:55.594429 [debug] [Thread-1  ]: Using postgres connection "seed.TP_note_DBT.raw_sales_data"
[0m15:55:55.595119 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: COMMIT
[0m15:55:55.599862 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:55:55.601450 [debug] [Thread-1  ]: Timing info for seed.TP_note_DBT.raw_sales_data (execute): 15:55:53.748479 => 15:55:55.601450
[0m15:55:55.602457 [debug] [Thread-1  ]: On seed.TP_note_DBT.raw_sales_data: Close
[0m15:55:55.604605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba0060ea-caed-42fc-aca5-4ed3c9518c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194995F3D0>]}
[0m15:55:55.605966 [info ] [Thread-1  ]: 2 of 2 OK loaded seed file public.raw_sales_data ............................... [[32mINSERT 500[0m in 1.86s]
[0m15:55:55.607962 [debug] [Thread-1  ]: Finished running node seed.TP_note_DBT.raw_sales_data
[0m15:55:55.610730 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:55.611598 [debug] [MainThread]: On master: BEGIN
[0m15:55:55.612478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:55.643235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:55:55.645538 [debug] [MainThread]: On master: COMMIT
[0m15:55:55.647252 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:55.649279 [debug] [MainThread]: On master: COMMIT
[0m15:55:55.654049 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:55:55.656167 [debug] [MainThread]: On master: Close
[0m15:55:55.660007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:55.663323 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:55:55.665458 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m15:55:55.668721 [debug] [MainThread]: Connection 'seed.TP_note_DBT.raw_sales_data' was properly closed.
[0m15:55:55.671805 [info ] [MainThread]: 
[0m15:55:55.676015 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m15:55:55.683487 [debug] [MainThread]: Command end result
[0m15:55:55.715558 [info ] [MainThread]: 
[0m15:55:55.719540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:55.723540 [info ] [MainThread]: 
[0m15:55:55.726540 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:55:55.733828 [debug] [MainThread]: Command `dbt seed` succeeded at 15:55:55.732829 after 3.99 seconds
[0m15:55:55.735924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194696CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219491A7F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219498DCBE0>]}
[0m15:55:55.739652 [debug] [MainThread]: Flushing usage events
[0m16:01:42.334611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F2268AC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F228D544F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F228D54250>]}


============================== 16:01:42.342517 | c39512b3-7739-44aa-9067-564623c16c47 ==============================
[0m16:01:42.342517 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:01:42.343603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:42.706054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c39512b3-7739-44aa-9067-564623c16c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F2290F0D90>]}
[0m16:01:42.832149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c39512b3-7739-44aa-9067-564623c16c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F228D34E80>]}
[0m16:01:42.833153 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:01:42.848803 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:01:42.997643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:01:42.998690 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\stg_products.sql
[0m16:01:43.239332 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.TP_note_DBT.stg_products' (models\stg_products.sql) depends on a source named 'raw.raw_product_data' which was not found
[0m16:01:43.247416 [debug] [MainThread]: Command `dbt run` failed at 16:01:43.246415 after 1.01 seconds
[0m16:01:43.249371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F2268AC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F22968DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F2296E22E0>]}
[0m16:01:43.252481 [debug] [MainThread]: Flushing usage events
[0m16:02:08.707089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149972B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149BE14D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149BE146D0>]}


============================== 16:02:08.721393 | 58573dd6-4cf6-4cd1-a076-df9502c5d3a8 ==============================
[0m16:02:08.721393 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:02:08.724388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_products', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:02:09.208575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58573dd6-4cf6-4cd1-a076-df9502c5d3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B76A730>]}
[0m16:02:09.363915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58573dd6-4cf6-4cd1-a076-df9502c5d3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149BE47070>]}
[0m16:02:09.367093 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:02:09.393458 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:02:09.633553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:02:09.636186 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\stg_products.sql
[0m16:02:09.831291 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_products (models\stg_products.sql)
  source() takes exactly two arguments (1 given)
[0m16:02:09.833827 [debug] [MainThread]: Command `dbt run` failed at 16:02:09.833827 after 1.23 seconds
[0m16:02:09.834871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149972B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149C4A3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149C5C6D30>]}
[0m16:02:09.835875 [debug] [MainThread]: Flushing usage events
[0m16:02:29.758806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16AA6B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16CF63970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16CF533A0>]}


============================== 16:02:29.771797 | 157a2937-f464-47a2-b4d5-29e140091684 ==============================
[0m16:02:29.771797 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:02:29.774794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_products', 'send_anonymous_usage_stats': 'True'}
[0m16:02:30.246717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '157a2937-f464-47a2-b4d5-29e140091684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16CF63130>]}
[0m16:02:30.435324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '157a2937-f464-47a2-b4d5-29e140091684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16CF4B4C0>]}
[0m16:02:30.437324 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:02:30.456378 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:02:30.727631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:02:30.729631 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\stg_products.sql
[0m16:02:31.002616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '157a2937-f464-47a2-b4d5-29e140091684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16D9730D0>]}
[0m16:02:31.025545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '157a2937-f464-47a2-b4d5-29e140091684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16D5D7D90>]}
[0m16:02:31.026548 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:02:31.028540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '157a2937-f464-47a2-b4d5-29e140091684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16D5D7E80>]}
[0m16:02:31.030576 [info ] [MainThread]: 
[0m16:02:31.033579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:31.036547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:02:31.057800 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:02:31.058846 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:02:31.060274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:31.092101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:02:31.095211 [debug] [ThreadPool]: On list_postgres: Close
[0m16:02:31.100289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:02:31.112934 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:02:31.113934 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:02:31.114934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:31.148984 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:02:31.150743 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:02:31.152516 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:02:31.160668 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:02:31.163723 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:02:31.167463 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:02:31.181112 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:31.182547 [debug] [MainThread]: On master: BEGIN
[0m16:02:31.183258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:31.214750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:31.216690 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:31.217881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:31.227371 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:31.230912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '157a2937-f464-47a2-b4d5-29e140091684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16D4B15B0>]}
[0m16:02:31.232563 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:31.236075 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:31.237766 [debug] [MainThread]: On master: BEGIN
[0m16:02:31.243578 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:31.244590 [debug] [MainThread]: On master: COMMIT
[0m16:02:31.246588 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:31.248123 [debug] [MainThread]: On master: COMMIT
[0m16:02:31.251998 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:31.253824 [debug] [MainThread]: On master: Close
[0m16:02:31.257563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:31.260221 [info ] [MainThread]: 
[0m16:02:31.268541 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.stg_products
[0m16:02:31.270541 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m16:02:31.274545 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.stg_products'
[0m16:02:31.276541 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.stg_products
[0m16:02:31.297083 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.stg_products"
[0m16:02:31.300082 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.stg_products (compile): 16:02:31.278561 => 16:02:31.299083
[0m16:02:31.301085 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.stg_products
[0m16:02:31.402282 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.stg_products"
[0m16:02:31.404696 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_products"
[0m16:02:31.405204 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: BEGIN
[0m16:02:31.407222 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:02:31.434544 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:02:31.435629 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_products"
[0m16:02:31.437257 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.stg_products"} */

  create view "postgres"."public"."stg_products__dbt_tmp"
    
    
  as (
    

select
    product_id,
    product_name::varchar(255) as product_name,
    category::varchar(50) as category,
    price::numeric(10, 2) as price
from "postgres"."public"."raw_product_data"

select * from stg_sales
  );
[0m16:02:31.441069 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16: select * from stg_sales
         ^

[0m16:02:31.442242 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: ROLLBACK
[0m16:02:31.445093 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.stg_products (execute): 16:02:31.302082 => 16:02:31.444498
[0m16:02:31.446137 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: Close
[0m16:02:31.458278 [debug] [Thread-1  ]: Database Error in model stg_products (models\stg_products.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target\run\TP_note_DBT\models\stg_products.sql
[0m16:02:31.460343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '157a2937-f464-47a2-b4d5-29e140091684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16DA757F0>]}
[0m16:02:31.462742 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.19s]
[0m16:02:31.464907 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.stg_products
[0m16:02:31.468158 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:31.469259 [debug] [MainThread]: On master: BEGIN
[0m16:02:31.470358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:31.500653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:31.501812 [debug] [MainThread]: On master: COMMIT
[0m16:02:31.502983 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:31.504091 [debug] [MainThread]: On master: COMMIT
[0m16:02:31.506926 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:31.508501 [debug] [MainThread]: On master: Close
[0m16:02:31.510159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:31.511310 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:02:31.512353 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:02:31.513493 [debug] [MainThread]: Connection 'model.TP_note_DBT.stg_products' was properly closed.
[0m16:02:31.514665 [info ] [MainThread]: 
[0m16:02:31.516312 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:02:31.519085 [debug] [MainThread]: Command end result
[0m16:02:31.537479 [info ] [MainThread]: 
[0m16:02:31.539480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:02:31.540777 [info ] [MainThread]: 
[0m16:02:31.542786 [error] [MainThread]:   Database Error in model stg_products (models\stg_products.sql)
  syntax error at or near "select"
  LINE 16: select * from stg_sales
           ^
  compiled Code at target\run\TP_note_DBT\models\stg_products.sql
[0m16:02:31.545789 [info ] [MainThread]: 
[0m16:02:31.546787 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:02:31.551005 [debug] [MainThread]: Command `dbt run` failed at 16:02:31.551005 after 1.92 seconds
[0m16:02:31.553994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16AA6B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16CF4B4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16D5D7D90>]}
[0m16:02:31.555995 [debug] [MainThread]: Flushing usage events
[0m16:02:45.815425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB46ACE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB69A4E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB6994970>]}


============================== 16:02:45.832202 | 64793388-4ffc-47da-833d-bdf7a40a9fb7 ==============================
[0m16:02:45.832202 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:02:45.835194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_products', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:46.430304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64793388-4ffc-47da-833d-bdf7a40a9fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB69A42B0>]}
[0m16:02:46.652231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64793388-4ffc-47da-833d-bdf7a40a9fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB6E91C10>]}
[0m16:02:46.654226 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:02:46.671768 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:02:46.842567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:46.843567 [debug] [MainThread]: Partial parsing: updated file: TP_note_DBT://models\stg_products.sql
[0m16:02:47.049973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64793388-4ffc-47da-833d-bdf7a40a9fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB73BC0D0>]}
[0m16:02:47.075932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64793388-4ffc-47da-833d-bdf7a40a9fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB6F69280>]}
[0m16:02:47.077933 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:02:47.080049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64793388-4ffc-47da-833d-bdf7a40a9fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB72509A0>]}
[0m16:02:47.083063 [info ] [MainThread]: 
[0m16:02:47.087797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:47.091823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:02:47.120504 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:02:47.122455 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:02:47.124466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:47.172341 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:02:47.175830 [debug] [ThreadPool]: On list_postgres: Close
[0m16:02:47.182564 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:02:47.195669 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:02:47.196666 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:02:47.198666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:47.224636 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:02:47.225808 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:02:47.226995 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:02:47.233172 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:02:47.235364 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:02:47.238478 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:02:47.249231 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:47.250226 [debug] [MainThread]: On master: BEGIN
[0m16:02:47.250735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:47.274773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:47.275919 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:47.276966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:47.283919 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:47.287068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64793388-4ffc-47da-833d-bdf7a40a9fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB73BC580>]}
[0m16:02:47.288143 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:47.291095 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:47.291747 [debug] [MainThread]: On master: BEGIN
[0m16:02:47.295537 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:47.296697 [debug] [MainThread]: On master: COMMIT
[0m16:02:47.297732 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:47.298259 [debug] [MainThread]: On master: COMMIT
[0m16:02:47.300671 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:47.301724 [debug] [MainThread]: On master: Close
[0m16:02:47.303725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:47.304232 [info ] [MainThread]: 
[0m16:02:47.311653 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.stg_products
[0m16:02:47.312782 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m16:02:47.315606 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.stg_products'
[0m16:02:47.316683 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.stg_products
[0m16:02:47.332367 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.stg_products"
[0m16:02:47.334682 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.stg_products (compile): 16:02:47.317200 => 16:02:47.334682
[0m16:02:47.335695 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.stg_products
[0m16:02:47.409071 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.stg_products"
[0m16:02:47.411072 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_products"
[0m16:02:47.412073 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: BEGIN
[0m16:02:47.413072 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:02:47.439675 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:02:47.441338 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_products"
[0m16:02:47.442443 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.stg_products"} */

  create view "postgres"."public"."stg_products__dbt_tmp"
    
    
  as (
    

select
    product_id,
    product_name::varchar(255) as product_name,
    category::varchar(50) as category,
    price::numeric(10, 2) as price
from "postgres"."public"."raw_product_data"
  );
[0m16:02:47.448203 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:02:47.462436 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_products"
[0m16:02:47.464434 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.stg_products"} */
alter table "postgres"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m16:02:47.467737 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:47.505792 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: COMMIT
[0m16:02:47.507797 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_products"
[0m16:02:47.508793 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: COMMIT
[0m16:02:47.519311 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:02:47.537486 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."stg_products__dbt_backup"
[0m16:02:47.552100 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.stg_products"
[0m16:02:47.553692 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.stg_products"} */
drop view if exists "postgres"."public"."stg_products__dbt_backup" cascade
[0m16:02:47.559014 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:02:47.564373 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.stg_products (execute): 16:02:47.337792 => 16:02:47.563664
[0m16:02:47.565823 [debug] [Thread-1  ]: On model.TP_note_DBT.stg_products: Close
[0m16:02:47.568434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64793388-4ffc-47da-833d-bdf7a40a9fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB749F160>]}
[0m16:02:47.570174 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:02:47.572063 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.stg_products
[0m16:02:47.575140 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:47.576282 [debug] [MainThread]: On master: BEGIN
[0m16:02:47.577417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:47.605184 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:47.606547 [debug] [MainThread]: On master: COMMIT
[0m16:02:47.607599 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:47.608147 [debug] [MainThread]: On master: COMMIT
[0m16:02:47.610816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:47.611899 [debug] [MainThread]: On master: Close
[0m16:02:47.613570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:47.614668 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:02:47.615213 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:02:47.616446 [debug] [MainThread]: Connection 'model.TP_note_DBT.stg_products' was properly closed.
[0m16:02:47.618052 [info ] [MainThread]: 
[0m16:02:47.619433 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:02:47.621934 [debug] [MainThread]: Command end result
[0m16:02:47.637887 [info ] [MainThread]: 
[0m16:02:47.639908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:47.642482 [info ] [MainThread]: 
[0m16:02:47.644397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:02:47.648279 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:47.647769 after 2.01 seconds
[0m16:02:47.649289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB46ACE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB740DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB6D20C10>]}
[0m16:02:47.651290 [debug] [MainThread]: Flushing usage events
[0m16:06:34.821619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB116AC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB13B944F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB13B94250>]}


============================== 16:06:34.832028 | 0279b88b-0ff8-4df4-b878-617580549022 ==============================
[0m16:06:34.832028 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:06:34.834372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_sales', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:35.254240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0279b88b-0ff8-4df4-b878-617580549022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB13F21D90>]}
[0m16:06:35.455022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0279b88b-0ff8-4df4-b878-617580549022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB13B74E80>]}
[0m16:06:35.456985 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:06:35.473988 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:06:35.744921 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m16:06:35.746921 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\staging\models.yml
[0m16:06:35.747921 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\staging\stg_sales.sql
[0m16:06:35.748921 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\staging\stg_products.sql
[0m16:06:35.749921 [debug] [MainThread]: Partial parsing: deleted file: TP_note_DBT://models\example\stg_sales.sql
[0m16:06:35.750921 [debug] [MainThread]: Partial parsing: deleted file: TP_note_DBT://models\stg_products.sql
[0m16:06:36.319243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0279b88b-0ff8-4df4-b878-617580549022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1471ED90>]}
[0m16:06:36.345377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0279b88b-0ff8-4df4-b878-617580549022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB14169070>]}
[0m16:06:36.346377 [info ] [MainThread]: Found 4 models, 2 seeds, 6 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:06:36.348374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0279b88b-0ff8-4df4-b878-617580549022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB141692E0>]}
[0m16:06:36.351374 [info ] [MainThread]: 
[0m16:06:36.354374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:36.358374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:06:36.390696 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:06:36.391699 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:06:36.393697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:36.429581 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:06:36.431185 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:06:36.432891 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:06:36.441679 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:06:36.446068 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:06:36.449869 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:06:36.521622 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:36.523622 [debug] [MainThread]: On master: BEGIN
[0m16:06:36.524623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:36.556552 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:06:36.558278 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:36.559893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:36.570589 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:06:36.575129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0279b88b-0ff8-4df4-b878-617580549022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1471EFD0>]}
[0m16:06:36.578396 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:36.583385 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:36.585013 [debug] [MainThread]: On master: BEGIN
[0m16:06:36.590356 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:06:36.592035 [debug] [MainThread]: On master: COMMIT
[0m16:06:36.593100 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:36.594747 [debug] [MainThread]: On master: COMMIT
[0m16:06:36.598006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:06:36.599660 [debug] [MainThread]: On master: Close
[0m16:06:36.602293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:36.604582 [info ] [MainThread]: 
[0m16:06:36.611931 [debug] [Thread-1  ]: Began running node test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:36.613561 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_sales_sale_id ................................... [RUN]
[0m16:06:36.616810 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929'
[0m16:06:36.618808 [debug] [Thread-1  ]: Began compiling node test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:36.658193 [debug] [Thread-1  ]: Writing injected SQL for node "test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:36.663192 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929 (compile): 16:06:36.619810 => 16:06:36.662192
[0m16:06:36.665193 [debug] [Thread-1  ]: Began executing node test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:36.702748 [debug] [Thread-1  ]: Writing runtime sql for node "test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:36.707053 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:36.709097 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929: BEGIN
[0m16:06:36.711123 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:06:36.749434 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:06:36.751876 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:36.752967 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "postgres"."public"."stg_sales"
where sale_id is null



      
    ) dbt_internal_test
[0m16:06:36.761315 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:06:36.767541 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929 (execute): 16:06:36.666194 => 16:06:36.766530
[0m16:06:36.769748 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929: ROLLBACK
[0m16:06:36.773643 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929: Close
[0m16:06:36.777405 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_sales_sale_id ......................................... [[32mPASS[0m in 0.16s]
[0m16:06:36.781173 [debug] [Thread-1  ]: Finished running node test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:36.783478 [debug] [Thread-1  ]: Began running node test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:36.785567 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_sales_sale_id ..................................... [RUN]
[0m16:06:36.788921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.TP_note_DBT.not_null_stg_sales_sale_id.6b07c53929, now test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521)
[0m16:06:36.791369 [debug] [Thread-1  ]: Began compiling node test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:36.809915 [debug] [Thread-1  ]: Writing injected SQL for node "test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:36.813929 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521 (compile): 16:06:36.792893 => 16:06:36.812932
[0m16:06:36.815944 [debug] [Thread-1  ]: Began executing node test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:36.823524 [debug] [Thread-1  ]: Writing runtime sql for node "test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:36.826535 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:36.828535 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521: BEGIN
[0m16:06:36.830043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:06:36.868319 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:06:36.870573 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:36.872222 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sale_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_sales"
where sale_id is not null
group by sale_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:36.878253 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:06:36.883805 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521 (execute): 16:06:36.816940 => 16:06:36.882806
[0m16:06:36.885804 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521: ROLLBACK
[0m16:06:36.890249 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521: Close
[0m16:06:36.894013 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_sales_sale_id ........................................... [[32mPASS[0m in 0.11s]
[0m16:06:36.897037 [debug] [Thread-1  ]: Finished running node test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:36.901992 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:36.903081 [debug] [MainThread]: On master: BEGIN
[0m16:06:36.904707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:36.938290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:06:36.939910 [debug] [MainThread]: On master: COMMIT
[0m16:06:36.941529 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:36.943747 [debug] [MainThread]: On master: COMMIT
[0m16:06:36.947202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:06:36.949430 [debug] [MainThread]: On master: Close
[0m16:06:36.953170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:36.955403 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:06:36.957556 [debug] [MainThread]: Connection 'test.TP_note_DBT.unique_stg_sales_sale_id.8a4f7c9521' was properly closed.
[0m16:06:36.959481 [info ] [MainThread]: 
[0m16:06:36.961759 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m16:06:36.966173 [debug] [MainThread]: Command end result
[0m16:06:36.989502 [info ] [MainThread]: 
[0m16:06:36.991010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:36.994342 [info ] [MainThread]: 
[0m16:06:36.996342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:06:37.000732 [debug] [MainThread]: Command `dbt test` succeeded at 16:06:37.000732 after 2.34 seconds
[0m16:06:37.003151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB116AC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB13F435B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1457EB80>]}
[0m16:06:37.005149 [debug] [MainThread]: Flushing usage events
[0m16:09:53.502354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002311DE2C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231202E4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231202D53A0>]}


============================== 16:09:53.516353 | c45de93e-78e4-456c-bff7-d7604db0643c ==============================
[0m16:09:53.516353 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:09:53.519355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:54.008768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45de93e-78e4-456c-bff7-d7604db0643c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231202E4130>]}
[0m16:09:54.264072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c45de93e-78e4-456c-bff7-d7604db0643c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231202CB4C0>]}
[0m16:09:54.267376 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:09:54.294102 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:09:54.571656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:09:54.573663 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\staging\modelsbis.yml
[0m16:09:54.903864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c45de93e-78e4-456c-bff7-d7604db0643c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023120B64940>]}
[0m16:09:54.948867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c45de93e-78e4-456c-bff7-d7604db0643c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023120776C70>]}
[0m16:09:54.951865 [info ] [MainThread]: Found 4 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:09:54.955265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45de93e-78e4-456c-bff7-d7604db0643c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023120A29E80>]}
[0m16:09:54.959052 [info ] [MainThread]: 
[0m16:09:54.963321 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:54.970229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:09:55.002923 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:09:55.005209 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:09:55.006219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:55.057228 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:09:55.059408 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:09:55.060586 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:09:55.071297 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:09:55.075015 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:09:55.078268 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:09:55.092328 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:55.093970 [debug] [MainThread]: On master: BEGIN
[0m16:09:55.095068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:55.121569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:55.123179 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:55.124272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:55.132419 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:09:55.135964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45de93e-78e4-456c-bff7-d7604db0643c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023120520580>]}
[0m16:09:55.136969 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:55.139837 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:55.140900 [debug] [MainThread]: On master: BEGIN
[0m16:09:55.144964 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:55.146029 [debug] [MainThread]: On master: COMMIT
[0m16:09:55.147120 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:55.147656 [debug] [MainThread]: On master: COMMIT
[0m16:09:55.149809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:55.151325 [debug] [MainThread]: On master: Close
[0m16:09:55.152659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:55.154312 [info ] [MainThread]: 
[0m16:09:55.159089 [debug] [Thread-1  ]: Began running node test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3
[0m16:09:55.161302 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_products_product_id ............................. [RUN]
[0m16:09:55.164035 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3'
[0m16:09:55.165365 [debug] [Thread-1  ]: Began compiling node test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3
[0m16:09:55.203143 [debug] [Thread-1  ]: Writing injected SQL for node "test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3"
[0m16:09:55.210321 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3 (compile): 16:09:55.167156 => 16:09:55.208079
[0m16:09:55.211419 [debug] [Thread-1  ]: Began executing node test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3
[0m16:09:55.243458 [debug] [Thread-1  ]: Writing runtime sql for node "test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3"
[0m16:09:55.246454 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3"
[0m16:09:55.247811 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m16:09:55.249820 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:09:55.280635 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:09:55.282387 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3"
[0m16:09:55.284626 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "postgres"."public"."stg_products"
where product_id is null



      
    ) dbt_internal_test
[0m16:09:55.289849 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:09:55.294489 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3 (execute): 16:09:55.212464 => 16:09:55.294489
[0m16:09:55.296489 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m16:09:55.300386 [debug] [Thread-1  ]: On test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3: Close
[0m16:09:55.303395 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_products_product_id ................................... [[32mPASS[0m in 0.14s]
[0m16:09:55.306269 [debug] [Thread-1  ]: Finished running node test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3
[0m16:09:55.308484 [debug] [Thread-1  ]: Began running node test.TP_note_DBT.unique_stg_products_product_id.7d950a1467
[0m16:09:55.310113 [info ] [Thread-1  ]: 2 of 2 START test unique_stg_products_product_id ............................... [RUN]
[0m16:09:55.313042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.TP_note_DBT.not_null_stg_products_product_id.6373b0acf3, now test.TP_note_DBT.unique_stg_products_product_id.7d950a1467)
[0m16:09:55.315214 [debug] [Thread-1  ]: Began compiling node test.TP_note_DBT.unique_stg_products_product_id.7d950a1467
[0m16:09:55.333346 [debug] [Thread-1  ]: Writing injected SQL for node "test.TP_note_DBT.unique_stg_products_product_id.7d950a1467"
[0m16:09:55.337011 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.unique_stg_products_product_id.7d950a1467 (compile): 16:09:55.316371 => 16:09:55.336501
[0m16:09:55.339021 [debug] [Thread-1  ]: Began executing node test.TP_note_DBT.unique_stg_products_product_id.7d950a1467
[0m16:09:55.347693 [debug] [Thread-1  ]: Writing runtime sql for node "test.TP_note_DBT.unique_stg_products_product_id.7d950a1467"
[0m16:09:55.351707 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.unique_stg_products_product_id.7d950a1467"
[0m16:09:55.353704 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_products_product_id.7d950a1467: BEGIN
[0m16:09:55.355705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:55.395420 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:09:55.397205 [debug] [Thread-1  ]: Using postgres connection "test.TP_note_DBT.unique_stg_products_product_id.7d950a1467"
[0m16:09:55.398855 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "test.TP_note_DBT.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:09:55.404686 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:09:55.408823 [debug] [Thread-1  ]: Timing info for test.TP_note_DBT.unique_stg_products_product_id.7d950a1467 (execute): 16:09:55.341022 => 16:09:55.407821
[0m16:09:55.409820 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m16:09:55.413252 [debug] [Thread-1  ]: On test.TP_note_DBT.unique_stg_products_product_id.7d950a1467: Close
[0m16:09:55.416141 [info ] [Thread-1  ]: 2 of 2 PASS unique_stg_products_product_id ..................................... [[32mPASS[0m in 0.10s]
[0m16:09:55.419491 [debug] [Thread-1  ]: Finished running node test.TP_note_DBT.unique_stg_products_product_id.7d950a1467
[0m16:09:55.423138 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:55.424773 [debug] [MainThread]: On master: BEGIN
[0m16:09:55.425858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:55.456849 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:55.458478 [debug] [MainThread]: On master: COMMIT
[0m16:09:55.460099 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:55.461712 [debug] [MainThread]: On master: COMMIT
[0m16:09:55.464948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:55.466031 [debug] [MainThread]: On master: Close
[0m16:09:55.468034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:55.470058 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:09:55.471686 [debug] [MainThread]: Connection 'test.TP_note_DBT.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m16:09:55.473311 [info ] [MainThread]: 
[0m16:09:55.474925 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m16:09:55.478181 [debug] [MainThread]: Command end result
[0m16:09:55.567800 [info ] [MainThread]: 
[0m16:09:55.569930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:55.571531 [info ] [MainThread]: 
[0m16:09:55.573445 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:09:55.579191 [debug] [MainThread]: Command `dbt test` succeeded at 16:09:55.578039 after 2.24 seconds
[0m16:09:55.581622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002311DE2C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023120493E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023120560B50>]}
[0m16:09:55.583614 [debug] [MainThread]: Flushing usage events
[0m16:16:21.478881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219407AB8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021942E54D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021942E546D0>]}


============================== 16:16:21.487882 | 602be8c2-ac25-4b9f-b3db-b1261858c58d ==============================
[0m16:16:21.487882 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:16:21.489787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models marts.daily_sales_revenue_by_category', 'send_anonymous_usage_stats': 'True'}
[0m16:16:22.008989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '602be8c2-ac25-4b9f-b3db-b1261858c58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219427AA730>]}
[0m16:16:22.136908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '602be8c2-ac25-4b9f-b3db-b1261858c58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021942E85070>]}
[0m16:16:22.138913 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:16:22.152546 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:16:22.302458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:16:22.303454 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\marts\daily_sales_volume.sql
[0m16:16:22.304458 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:16:22.575100 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.TP_note_DBT.daily_sales_revenue_by_category' (models\marts\daily_sales_revenue_by_category.sql) depends on a source named 'stg_sales.stg_products' which was not found
[0m16:16:22.580100 [debug] [MainThread]: Command `dbt run` failed at 16:16:22.580100 after 1.20 seconds
[0m16:16:22.582103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219407AB8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021943541A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021943664490>]}
[0m16:16:22.584101 [debug] [MainThread]: Flushing usage events
[0m16:17:04.291203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931C12CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931E824E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931E814970>]}


============================== 16:17:04.300894 | ae18b60f-fbe8-4ac9-840a-35a3c57c7c39 ==============================
[0m16:17:04.300894 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:17:04.301868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:17:04.633297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae18b60f-fbe8-4ac9-840a-35a3c57c7c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931E8242B0>]}
[0m16:17:04.850207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae18b60f-fbe8-4ac9-840a-35a3c57c7c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931EB11C10>]}
[0m16:17:04.852466 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:17:04.871308 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:17:05.024475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:17:05.025486 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:17:05.026480 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\marts\daily_sales_volume.sql
[0m16:17:05.214012 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.TP_note_DBT.daily_sales_revenue_by_category' (models\marts\daily_sales_revenue_by_category.sql) depends on a source named 'stg_sales.stg_products' which was not found
[0m16:17:05.218027 [debug] [MainThread]: Command `dbt run` failed at 16:17:05.218027 after 1.03 seconds
[0m16:17:05.220047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931C12CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931EEFBD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931EFE4CA0>]}
[0m16:17:05.221079 [debug] [MainThread]: Flushing usage events
[0m16:18:09.468821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DB39B0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DDC94D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DDC94D30>]}


============================== 16:18:09.477777 | 6091d3c6-9723-4174-ba04-ff55532667b7 ==============================
[0m16:18:09.477777 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:18:09.479777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:18:09.929891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6091d3c6-9723-4174-ba04-ff55532667b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DDE20F40>]}
[0m16:18:10.066842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6091d3c6-9723-4174-ba04-ff55532667b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DDE0C940>]}
[0m16:18:10.069837 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:18:10.091314 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:18:10.325361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:18:10.326373 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\marts\daily_sales_volume.sql
[0m16:18:10.326373 [debug] [MainThread]: Partial parsing: added file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:18:10.588632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6091d3c6-9723-4174-ba04-ff55532667b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE4D80D0>]}
[0m16:18:10.629355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6091d3c6-9723-4174-ba04-ff55532667b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE325910>]}
[0m16:18:10.631885 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:18:10.633829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6091d3c6-9723-4174-ba04-ff55532667b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE325F70>]}
[0m16:18:10.638876 [info ] [MainThread]: 
[0m16:18:10.643819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:18:10.649820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:18:10.684482 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:18:10.686484 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:18:10.688474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:10.747693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:18:10.751736 [debug] [ThreadPool]: On list_postgres: Close
[0m16:18:10.762727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:18:10.784718 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:18:10.786720 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:18:10.788718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:10.830422 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:18:10.832044 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:18:10.833963 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:18:10.843647 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:18:10.848067 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:18:10.852111 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:18:10.870363 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:10.871995 [debug] [MainThread]: On master: BEGIN
[0m16:18:10.874015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:10.916142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:18:10.918484 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:10.920406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:18:10.932909 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:18:10.938138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6091d3c6-9723-4174-ba04-ff55532667b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE4CBC70>]}
[0m16:18:10.939936 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:10.944818 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:10.945879 [debug] [MainThread]: On master: BEGIN
[0m16:18:10.953112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:18:10.954919 [debug] [MainThread]: On master: COMMIT
[0m16:18:10.956743 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:10.958529 [debug] [MainThread]: On master: COMMIT
[0m16:18:10.962942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:18:10.964174 [debug] [MainThread]: On master: Close
[0m16:18:10.966811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:18:10.969376 [info ] [MainThread]: 
[0m16:18:10.979830 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:18:10.981635 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:18:10.986710 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:18:10.987706 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:18:11.013282 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:18:11.018293 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:18:10.989696 => 16:18:11.017295
[0m16:18:11.020291 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:18:11.135042 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:18:11.139028 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:18:11.141031 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:18:11.143033 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:18:11.186462 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:18:11.188855 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:18:11.190763 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    s.sale_date,
    p.category,
    sum(s.quantity * p.price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on s.product_id = p.product_id
group by s.sale_date, p.category;
  );
  
[0m16:18:11.195178 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: group by s.sale_date, p.category;
                                         ^

[0m16:18:11.196204 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:18:11.199565 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:18:11.021294 => 16:18:11.198850
[0m16:18:11.200682 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:18:11.206985 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:18:11.208585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091d3c6-9723-4174-ba04-ff55532667b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE485D90>]}
[0m16:18:11.209645 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.22s]
[0m16:18:11.211248 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:18:11.214551 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:11.215195 [debug] [MainThread]: On master: BEGIN
[0m16:18:11.215701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:11.242360 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:18:11.243421 [debug] [MainThread]: On master: COMMIT
[0m16:18:11.244540 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:11.245609 [debug] [MainThread]: On master: COMMIT
[0m16:18:11.247811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:18:11.248928 [debug] [MainThread]: On master: Close
[0m16:18:11.250601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:11.251671 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:18:11.252764 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:18:11.253294 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:18:11.254305 [info ] [MainThread]: 
[0m16:18:11.255307 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m16:18:11.257305 [debug] [MainThread]: Command end result
[0m16:18:11.273938 [info ] [MainThread]: 
[0m16:18:11.275938 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:18:11.278220 [info ] [MainThread]: 
[0m16:18:11.278764 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:18:11.281479 [info ] [MainThread]: 
[0m16:18:11.282819 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:18:11.286427 [debug] [MainThread]: Command `dbt run` failed at 16:18:11.286427 after 1.91 seconds
[0m16:18:11.288396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DB39B0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DDE20F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE325E20>]}
[0m16:18:11.289422 [debug] [MainThread]: Flushing usage events
[0m16:19:25.367376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B2EC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601D7D44F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601D7D4250>]}


============================== 16:19:25.381891 | 684f8a6d-cb0c-49ff-aa37-2129f857f52a ==============================
[0m16:19:25.381891 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:19:25.383894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:19:25.746944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '684f8a6d-cb0c-49ff-aa37-2129f857f52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601DB5FD90>]}
[0m16:19:25.889347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '684f8a6d-cb0c-49ff-aa37-2129f857f52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601D7B4E80>]}
[0m16:19:25.891318 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:19:25.908200 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:19:26.130922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:26.131921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:26.143924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '684f8a6d-cb0c-49ff-aa37-2129f857f52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601E0A60D0>]}
[0m16:19:26.169464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '684f8a6d-cb0c-49ff-aa37-2129f857f52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601DD36730>]}
[0m16:19:26.170463 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:19:26.171462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '684f8a6d-cb0c-49ff-aa37-2129f857f52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601DD36910>]}
[0m16:19:26.174468 [info ] [MainThread]: 
[0m16:19:26.176470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:26.179468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:19:26.203468 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:19:26.205465 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:19:26.206463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:26.241619 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:19:26.244071 [debug] [ThreadPool]: On list_postgres: Close
[0m16:19:26.249766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:19:26.266851 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:19:26.268865 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:19:26.268865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:26.304783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.306706 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:19:26.308225 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:19:26.318689 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:19:26.323388 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:19:26.327440 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:19:26.345581 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.347595 [debug] [MainThread]: On master: BEGIN
[0m16:19:26.349610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:26.392812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.394599 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.395853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:26.408936 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:19:26.414962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '684f8a6d-cb0c-49ff-aa37-2129f857f52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601DD36670>]}
[0m16:19:26.416962 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:26.421879 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.423765 [debug] [MainThread]: On master: BEGIN
[0m16:19:26.430682 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.432547 [debug] [MainThread]: On master: COMMIT
[0m16:19:26.434117 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.435625 [debug] [MainThread]: On master: COMMIT
[0m16:19:26.440335 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:26.441395 [debug] [MainThread]: On master: Close
[0m16:19:26.445425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:26.447444 [info ] [MainThread]: 
[0m16:19:26.458134 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:19:26.461053 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:19:26.464396 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:19:26.465530 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:19:26.490719 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:19:26.494963 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:19:26.467271 => 16:19:26.493960
[0m16:19:26.497267 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:19:26.609695 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:19:26.613707 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:19:26.614706 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:19:26.616761 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:19:26.659101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.660818 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:19:26.662941 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    s.sale_date,
    p.category,
    sum(s.quantity * p.price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on s.product_id = p.product_id
group by s.sale_date, p.category;
  );
  
[0m16:19:26.667984 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: group by s.sale_date, p.category;
                                         ^

[0m16:19:26.669997 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:19:26.673852 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:19:26.499284 => 16:19:26.673299
[0m16:19:26.674968 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:19:26.682262 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:19:26.683445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '684f8a6d-cb0c-49ff-aa37-2129f857f52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601E0CBEE0>]}
[0m16:19:26.685456 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.22s]
[0m16:19:26.687466 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:19:26.689990 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.690991 [debug] [MainThread]: On master: BEGIN
[0m16:19:26.691991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:26.726447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.729319 [debug] [MainThread]: On master: COMMIT
[0m16:19:26.731638 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.733345 [debug] [MainThread]: On master: COMMIT
[0m16:19:26.738486 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:26.741108 [debug] [MainThread]: On master: Close
[0m16:19:26.745328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:26.748124 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:19:26.749730 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:19:26.752750 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:19:26.755080 [info ] [MainThread]: 
[0m16:19:26.757125 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m16:19:26.759384 [debug] [MainThread]: Command end result
[0m16:19:26.791349 [info ] [MainThread]: 
[0m16:19:26.793641 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:19:26.796672 [info ] [MainThread]: 
[0m16:19:26.798628 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:19:26.801655 [info ] [MainThread]: 
[0m16:19:26.804284 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:19:26.811429 [debug] [MainThread]: Command `dbt run` failed at 16:19:26.810413 after 1.61 seconds
[0m16:19:26.813472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601B2EC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601DB5FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601DBC76D0>]}
[0m16:19:26.815244 [debug] [MainThread]: Flushing usage events
[0m16:20:40.037434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B706C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B93554F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B9355250>]}


============================== 16:20:40.051446 | 9c3743e2-1168-4c40-b64a-27dbac847884 ==============================
[0m16:20:40.051446 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:20:40.055054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:40.500952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c3743e2-1168-4c40-b64a-27dbac847884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B96DFD90>]}
[0m16:20:40.680170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c3743e2-1168-4c40-b64a-27dbac847884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B9334E80>]}
[0m16:20:40.682157 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:20:40.697480 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:20:40.920694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:40.922689 [debug] [MainThread]: Partial parsing: updated file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:20:41.281804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c3743e2-1168-4c40-b64a-27dbac847884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B9D9A0D0>]}
[0m16:20:41.315327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c3743e2-1168-4c40-b64a-27dbac847884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B98B6730>]}
[0m16:20:41.317283 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:20:41.319298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c3743e2-1168-4c40-b64a-27dbac847884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B98B6910>]}
[0m16:20:41.324338 [info ] [MainThread]: 
[0m16:20:41.328340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:41.332402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:20:41.358924 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:20:41.359926 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:20:41.360894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:41.393099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:20:41.396127 [debug] [ThreadPool]: On list_postgres: Close
[0m16:20:41.400302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:20:41.413624 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:20:41.415623 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:20:41.417622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:41.447155 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:41.448787 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:20:41.449933 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:20:41.458091 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:20:41.461360 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:20:41.465224 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:20:41.477537 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:41.478534 [debug] [MainThread]: On master: BEGIN
[0m16:20:41.480554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:41.511546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:41.512766 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:41.514425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:41.523371 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:20:41.527312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c3743e2-1168-4c40-b64a-27dbac847884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B9D8B2B0>]}
[0m16:20:41.529093 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:41.532104 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:41.533225 [debug] [MainThread]: On master: BEGIN
[0m16:20:41.537123 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:41.538209 [debug] [MainThread]: On master: COMMIT
[0m16:20:41.538877 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:41.540015 [debug] [MainThread]: On master: COMMIT
[0m16:20:41.542751 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:41.543292 [debug] [MainThread]: On master: Close
[0m16:20:41.545689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:41.546747 [info ] [MainThread]: 
[0m16:20:41.555598 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:20:41.556755 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:20:41.558583 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:20:41.560600 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:20:41.577677 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:20:41.580389 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:20:41.561592 => 16:20:41.579346
[0m16:20:41.581357 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:20:41.655028 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:20:41.657028 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:20:41.658198 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:20:41.659233 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:20:41.686272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:41.687357 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:20:41.689032 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    category,
    sum(quantity * price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on product_id = product_id
group by sale_date, category;
  );
  
[0m16:20:41.691846 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: group by sale_date, category;
                                     ^

[0m16:20:41.693612 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:20:41.696645 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:20:41.582487 => 16:20:41.696097
[0m16:20:41.697729 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:20:41.704727 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by sale_date, category;
                                       ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:20:41.706728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c3743e2-1168-4c40-b64a-27dbac847884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B9D498E0>]}
[0m16:20:41.707727 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.15s]
[0m16:20:41.710121 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:20:41.712651 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:41.713162 [debug] [MainThread]: On master: BEGIN
[0m16:20:41.714175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:41.740307 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:41.741486 [debug] [MainThread]: On master: COMMIT
[0m16:20:41.742911 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:41.743946 [debug] [MainThread]: On master: COMMIT
[0m16:20:41.747344 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:41.748972 [debug] [MainThread]: On master: Close
[0m16:20:41.750644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:41.752203 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:20:41.754288 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:20:41.754952 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:20:41.756075 [info ] [MainThread]: 
[0m16:20:41.757900 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:20:41.760228 [debug] [MainThread]: Command end result
[0m16:20:41.784113 [info ] [MainThread]: 
[0m16:20:41.785218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:20:41.787891 [info ] [MainThread]: 
[0m16:20:41.789935 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by sale_date, category;
                                       ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:20:41.791464 [info ] [MainThread]: 
[0m16:20:41.793502 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:20:41.797502 [debug] [MainThread]: Command `dbt run` failed at 16:20:41.797502 after 1.93 seconds
[0m16:20:41.799502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B706C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B96DFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B9D8B880>]}
[0m16:20:41.800501 [debug] [MainThread]: Flushing usage events
[0m16:22:30.860038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE98B2BE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B224E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B214970>]}


============================== 16:22:30.874051 | 46096f3c-c273-4c8d-8561-056b4d8385fd ==============================
[0m16:22:30.874051 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:22:30.877158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:22:31.250734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46096f3c-c273-4c8d-8561-056b4d8385fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B2242B0>]}
[0m16:22:31.408208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46096f3c-c273-4c8d-8561-056b4d8385fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B511C10>]}
[0m16:22:31.411207 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:22:31.429200 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:22:31.659392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:22:31.660391 [debug] [MainThread]: Partial parsing: updated file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:22:31.874506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46096f3c-c273-4c8d-8561-056b4d8385fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9BA5A0D0>]}
[0m16:22:31.893753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46096f3c-c273-4c8d-8561-056b4d8385fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B57B7C0>]}
[0m16:22:31.895232 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:22:31.896238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46096f3c-c273-4c8d-8561-056b4d8385fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B57B9A0>]}
[0m16:22:31.900521 [info ] [MainThread]: 
[0m16:22:31.902905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:31.905925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:22:31.923978 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:22:31.924979 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:22:31.925978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:31.956560 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:22:31.959645 [debug] [ThreadPool]: On list_postgres: Close
[0m16:22:31.964925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:22:31.976525 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:22:31.977525 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:22:31.978559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:32.005519 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:22:32.006685 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:22:32.007884 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:22:32.013836 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:22:32.016493 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:22:32.019431 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:22:32.035848 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:32.036848 [debug] [MainThread]: On master: BEGIN
[0m16:22:32.038847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:32.066314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:22:32.067624 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:32.068464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:32.076031 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:22:32.078792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46096f3c-c273-4c8d-8561-056b4d8385fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B49FBB0>]}
[0m16:22:32.079798 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:32.083057 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:32.084855 [debug] [MainThread]: On master: BEGIN
[0m16:22:32.088700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:22:32.089769 [debug] [MainThread]: On master: COMMIT
[0m16:22:32.090855 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:32.091985 [debug] [MainThread]: On master: COMMIT
[0m16:22:32.094439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:22:32.095423 [debug] [MainThread]: On master: Close
[0m16:22:32.097043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:32.098684 [info ] [MainThread]: 
[0m16:22:32.105736 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:22:32.107765 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:22:32.110778 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:22:32.111776 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:22:32.128773 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:22:32.130772 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:22:32.112778 => 16:22:32.130772
[0m16:22:32.132449 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:22:32.240256 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:22:32.245492 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:22:32.247446 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:22:32.250452 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:22:32.292997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:22:32.295027 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:22:32.297036 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    s.sale_date,
    p.category,
    sum(s.quantity * p.price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on s.product_id = p.product_id
join "postgres"."public"."daily_sales_volume" d
    on s.sale_date = d.sale_date  -- Assurez-vous que la jointure est correcte
group by s.sale_date, p.category;
  );
  
[0m16:22:32.300684 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: group by s.sale_date, p.category;
                                         ^

[0m16:22:32.302201 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:22:32.305394 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:22:32.134460 => 16:22:32.304880
[0m16:22:32.306507 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:22:32.314352 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 23: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:22:32.315480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46096f3c-c273-4c8d-8561-056b4d8385fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9BA06C40>]}
[0m16:22:32.317939 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.21s]
[0m16:22:32.320360 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:22:32.323644 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:32.325668 [debug] [MainThread]: On master: BEGIN
[0m16:22:32.326670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:32.361776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:22:32.363755 [debug] [MainThread]: On master: COMMIT
[0m16:22:32.365231 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:32.366436 [debug] [MainThread]: On master: COMMIT
[0m16:22:32.370014 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:22:32.371902 [debug] [MainThread]: On master: Close
[0m16:22:32.373990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:32.376699 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:22:32.377717 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:22:32.380533 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:22:32.382306 [info ] [MainThread]: 
[0m16:22:32.385064 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:22:32.387924 [debug] [MainThread]: Command end result
[0m16:22:32.418726 [info ] [MainThread]: 
[0m16:22:32.421728 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:22:32.424729 [info ] [MainThread]: 
[0m16:22:32.426930 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 23: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:22:32.431873 [info ] [MainThread]: 
[0m16:22:32.435481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:22:32.441494 [debug] [MainThread]: Command `dbt run` failed at 16:22:32.440499 after 1.77 seconds
[0m16:22:32.443895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE98B2BE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B511C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9B42A070>]}
[0m16:22:32.447360 [debug] [MainThread]: Flushing usage events
[0m16:23:54.308369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA89E6C8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C353D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C3536D0>]}


============================== 16:23:54.321154 | 6cbdd84c-5cfa-4f67-85b5-332397eb0c0b ==============================
[0m16:23:54.321154 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:23:54.323318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:23:54.936718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cbdd84c-5cfa-4f67-85b5-332397eb0c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8BEAA730>]}
[0m16:23:55.206840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cbdd84c-5cfa-4f67-85b5-332397eb0c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C388070>]}
[0m16:23:55.209020 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:23:55.230882 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:23:55.419514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:23:55.420513 [debug] [MainThread]: Partial parsing: updated file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:23:55.705003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cbdd84c-5cfa-4f67-85b5-332397eb0c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8CD9A0D0>]}
[0m16:23:55.729628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cbdd84c-5cfa-4f67-85b5-332397eb0c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C8BB850>]}
[0m16:23:55.730740 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:23:55.732803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cbdd84c-5cfa-4f67-85b5-332397eb0c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C8BBA30>]}
[0m16:23:55.735681 [info ] [MainThread]: 
[0m16:23:55.737965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:55.741265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:23:55.764338 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:23:55.766302 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:23:55.767347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:55.810393 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:23:55.815966 [debug] [ThreadPool]: On list_postgres: Close
[0m16:23:55.821893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:23:55.839654 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:23:55.841654 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:23:55.842656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:55.875015 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:23:55.876823 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:23:55.878122 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:23:55.885606 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:23:55.888125 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:23:55.892642 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:23:55.907765 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:55.908863 [debug] [MainThread]: On master: BEGIN
[0m16:23:55.909871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:55.935499 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:23:55.937114 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:55.938996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:55.949446 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:23:55.954462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cbdd84c-5cfa-4f67-85b5-332397eb0c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C867AF0>]}
[0m16:23:55.956471 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:55.961336 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:55.962988 [debug] [MainThread]: On master: BEGIN
[0m16:23:55.970352 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:23:55.972009 [debug] [MainThread]: On master: COMMIT
[0m16:23:55.973779 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:55.975439 [debug] [MainThread]: On master: COMMIT
[0m16:23:55.979301 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:23:55.981431 [debug] [MainThread]: On master: Close
[0m16:23:55.984738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:55.986872 [info ] [MainThread]: 
[0m16:23:55.998139 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:23:56.001863 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:23:56.006874 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:23:56.008899 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:23:56.043026 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:23:56.047012 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:23:56.011803 => 16:23:56.046013
[0m16:23:56.049013 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:23:56.170602 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:23:56.175116 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:23:56.178418 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:23:56.182895 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:23:56.227462 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:23:56.229418 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:23:56.230895 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    category,
    sum(quantity * price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on product_id = product_id
join "postgres"."public"."daily_sales_volume" d
    on sale_date = sale_date  -- Assurez-vous que la jointure est correcte
group by sale_date, category;
  );
  
[0m16:23:56.235407 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: group by sale_date, category;
                                     ^

[0m16:23:56.235920 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:23:56.240085 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:23:56.050010 => 16:23:56.239242
[0m16:23:56.241208 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:23:56.249084 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 23: group by sale_date, category;
                                       ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:23:56.250155 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cbdd84c-5cfa-4f67-85b5-332397eb0c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8CD4AC10>]}
[0m16:23:56.251841 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.25s]
[0m16:23:56.254124 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:23:56.257418 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:56.258428 [debug] [MainThread]: On master: BEGIN
[0m16:23:56.259428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:56.286311 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:23:56.287401 [debug] [MainThread]: On master: COMMIT
[0m16:23:56.288476 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:56.289548 [debug] [MainThread]: On master: COMMIT
[0m16:23:56.292809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:23:56.295685 [debug] [MainThread]: On master: Close
[0m16:23:56.298155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:56.299795 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:23:56.300952 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:23:56.301809 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:23:56.303007 [info ] [MainThread]: 
[0m16:23:56.304494 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:23:56.307103 [debug] [MainThread]: Command end result
[0m16:23:56.325995 [info ] [MainThread]: 
[0m16:23:56.329452 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:23:56.331631 [info ] [MainThread]: 
[0m16:23:56.332976 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 23: group by sale_date, category;
                                       ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:23:56.335478 [info ] [MainThread]: 
[0m16:23:56.336613 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:23:56.340700 [debug] [MainThread]: Command `dbt run` failed at 16:23:56.339688 after 2.16 seconds
[0m16:23:56.341700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA89E6C8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C388070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA8C851790>]}
[0m16:23:56.342700 [debug] [MainThread]: Flushing usage events
[0m16:26:12.592943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7BFAB8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E694D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E6946D0>]}


============================== 16:26:12.606615 | 56245768-5d14-4390-8b2d-f255ba73ed6a ==============================
[0m16:26:12.606615 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:26:12.609374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select daily_sales_revenue_by_category', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:26:12.948211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56245768-5d14-4390-8b2d-f255ba73ed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7DFEA730>]}
[0m16:26:13.075344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56245768-5d14-4390-8b2d-f255ba73ed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E6C5070>]}
[0m16:26:13.077344 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:26:13.087884 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:26:13.294943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:13.295944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:13.304944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56245768-5d14-4390-8b2d-f255ba73ed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7ED660D0>]}
[0m16:26:13.323458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56245768-5d14-4390-8b2d-f255ba73ed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E9FF850>]}
[0m16:26:13.325460 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:26:13.326458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56245768-5d14-4390-8b2d-f255ba73ed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E9FFA30>]}
[0m16:26:13.329459 [info ] [MainThread]: 
[0m16:26:13.330459 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:26:13.332460 [debug] [MainThread]: Command end result
[0m16:26:13.350340 [debug] [MainThread]: Command `dbt test` succeeded at 16:26:13.350340 after 0.88 seconds
[0m16:26:13.351344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7BFAB8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E6C5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E9FF910>]}
[0m16:26:13.353306 [debug] [MainThread]: Flushing usage events
[0m16:26:30.615693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE61BBB0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE616E6CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE64493970>]}


============================== 16:26:30.625754 | 353c7514-bf8b-48c5-a021-32ac7acf46b7 ==============================
[0m16:26:30.625754 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:26:30.627726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select daily_sales_volume', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:26:30.975597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '353c7514-bf8b-48c5-a021-32ac7acf46b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE616E6CA0>]}
[0m16:26:31.114870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '353c7514-bf8b-48c5-a021-32ac7acf46b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE64182BE0>]}
[0m16:26:31.115870 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:26:31.128489 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:26:31.322514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:31.323514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:31.339026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '353c7514-bf8b-48c5-a021-32ac7acf46b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE64BA60D0>]}
[0m16:26:31.372872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '353c7514-bf8b-48c5-a021-32ac7acf46b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE64A3E820>]}
[0m16:26:31.374871 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:26:31.377933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '353c7514-bf8b-48c5-a021-32ac7acf46b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE64A3EA00>]}
[0m16:26:31.381623 [info ] [MainThread]: 
[0m16:26:31.384006 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:26:31.387536 [debug] [MainThread]: Command end result
[0m16:26:31.416315 [debug] [MainThread]: Command `dbt test` succeeded at 16:26:31.415314 after 0.90 seconds
[0m16:26:31.418314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE61BBB0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE64182BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE64A3E8E0>]}
[0m16:26:31.420318 [debug] [MainThread]: Flushing usage events
[0m16:29:40.231186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8C46B340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8E955D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8E955D90>]}


============================== 16:29:40.240186 | 43cc8a00-1c1a-40f6-8444-448678dc0fd8 ==============================
[0m16:29:40.240186 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:29:40.241184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:40.559374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43cc8a00-1c1a-40f6-8444-448678dc0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8BD76D30>]}
[0m16:29:40.685044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43cc8a00-1c1a-40f6-8444-448678dc0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8E984040>]}
[0m16:29:40.687040 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:29:40.699967 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:29:40.920465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:40.922472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:40.937462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43cc8a00-1c1a-40f6-8444-448678dc0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8F2260D0>]}
[0m16:29:40.960133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43cc8a00-1c1a-40f6-8444-448678dc0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8EEBB880>]}
[0m16:29:40.961131 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:29:40.963133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43cc8a00-1c1a-40f6-8444-448678dc0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8EEBBA60>]}
[0m16:29:40.965128 [info ] [MainThread]: 
[0m16:29:40.967594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:40.969152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:29:40.986656 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:29:40.987631 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:29:40.988620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:41.016371 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:29:41.019013 [debug] [ThreadPool]: On list_postgres: Close
[0m16:29:41.022830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:29:41.033404 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:29:41.034432 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:29:41.035438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:41.062939 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:29:41.064175 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:29:41.065341 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:29:41.072019 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:29:41.074029 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:29:41.077673 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:29:41.088291 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:41.089733 [debug] [MainThread]: On master: BEGIN
[0m16:29:41.090485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:41.116321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:29:41.117486 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:41.118623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:41.126614 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:29:41.129588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43cc8a00-1c1a-40f6-8444-448678dc0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8EFF4C70>]}
[0m16:29:41.130577 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:41.133949 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:41.135414 [debug] [MainThread]: On master: BEGIN
[0m16:29:41.140084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:29:41.141146 [debug] [MainThread]: On master: COMMIT
[0m16:29:41.142256 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:41.142864 [debug] [MainThread]: On master: COMMIT
[0m16:29:41.145627 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:41.146133 [debug] [MainThread]: On master: Close
[0m16:29:41.148292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:41.149413 [info ] [MainThread]: 
[0m16:29:41.155038 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:29:41.156083 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:29:41.158053 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:29:41.159083 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:29:41.174830 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:29:41.177840 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:29:41.160283 => 16:29:41.176840
[0m16:29:41.178850 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:29:41.254916 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:29:41.257916 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:29:41.258913 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:29:41.259885 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:29:41.291707 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:29:41.293287 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:29:41.294418 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    category,
    sum(quantity * price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on product_id = product_id
join "postgres"."public"."daily_sales_volume" d
    on sale_date = sale_date  -- Assurez-vous que la jointure est correcte
group by sale_date, category;
  );
  
[0m16:29:41.298655 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: group by sale_date, category;
                                     ^

[0m16:29:41.300095 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:29:41.303966 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:29:41.179851 => 16:29:41.302919
[0m16:29:41.305206 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:29:41.314239 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 23: group by sale_date, category;
                                       ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:29:41.315902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43cc8a00-1c1a-40f6-8444-448678dc0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8F24DDC0>]}
[0m16:29:41.317652 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.16s]
[0m16:29:41.320243 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:29:41.323777 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:41.326053 [debug] [MainThread]: On master: BEGIN
[0m16:29:41.327022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:41.355486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:29:41.356549 [debug] [MainThread]: On master: COMMIT
[0m16:29:41.358210 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:41.359796 [debug] [MainThread]: On master: COMMIT
[0m16:29:41.362519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:29:41.363641 [debug] [MainThread]: On master: Close
[0m16:29:41.365344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:41.366460 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:29:41.367866 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:29:41.368923 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:29:41.370100 [info ] [MainThread]: 
[0m16:29:41.371774 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m16:29:41.373483 [debug] [MainThread]: Command end result
[0m16:29:41.395941 [info ] [MainThread]: 
[0m16:29:41.397942 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:29:41.400868 [info ] [MainThread]: 
[0m16:29:41.401960 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 23: group by sale_date, category;
                                       ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:29:41.404497 [info ] [MainThread]: 
[0m16:29:41.406520 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:29:41.412054 [debug] [MainThread]: Command `dbt run` failed at 16:29:41.412054 after 1.29 seconds
[0m16:29:41.414052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8C46B340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8E984040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E8F33E4F0>]}
[0m16:29:41.415049 [debug] [MainThread]: Flushing usage events
[0m16:30:30.786082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0892C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B014D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B014D30>]}


============================== 16:30:30.796093 | c34a5e9a-2985-40e9-bd6f-3072febe2799 ==============================
[0m16:30:30.796093 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:30:30.798460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:31.121364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c34a5e9a-2985-40e9-bd6f-3072febe2799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B1A0F40>]}
[0m16:30:31.286749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c34a5e9a-2985-40e9-bd6f-3072febe2799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B18C940>]}
[0m16:30:31.289753 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:30:31.311765 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:30:31.510007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:30:31.511965 [debug] [MainThread]: Partial parsing: updated file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:30:31.766846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c34a5e9a-2985-40e9-bd6f-3072febe2799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B8590D0>]}
[0m16:30:31.799546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c34a5e9a-2985-40e9-bd6f-3072febe2799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B37C7F0>]}
[0m16:30:31.801559 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:30:31.803507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34a5e9a-2985-40e9-bd6f-3072febe2799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B37C9D0>]}
[0m16:30:31.806559 [info ] [MainThread]: 
[0m16:30:31.810820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:31.814349 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:30:31.839934 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:30:31.840980 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:30:31.842938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:31.891174 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:30:31.895539 [debug] [ThreadPool]: On list_postgres: Close
[0m16:30:31.904296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:30:31.920958 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:30:31.923003 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:30:31.924463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:31.966053 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:30:31.968284 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:30:31.970000 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:30:31.976001 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:30:31.978575 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:30:31.981791 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:30:31.992022 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:31.992687 [debug] [MainThread]: On master: BEGIN
[0m16:30:31.993723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:32.017612 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:32.018657 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.020328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:32.029648 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:30:32.033484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c34a5e9a-2985-40e9-bd6f-3072febe2799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B29E4F0>]}
[0m16:30:32.034725 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:32.036941 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.038024 [debug] [MainThread]: On master: BEGIN
[0m16:30:32.042348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:32.043432 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.043981 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.045064 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.047401 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:32.048485 [debug] [MainThread]: On master: Close
[0m16:30:32.050356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:32.051367 [info ] [MainThread]: 
[0m16:30:32.058582 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:30:32.060118 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:30:32.062469 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:30:32.063479 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:30:32.081239 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:30:32.083286 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:30:32.064528 => 16:30:32.083286
[0m16:30:32.084296 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:30:32.152555 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:30:32.155603 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:30:32.156603 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:30:32.157601 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:30:32.186972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:30:32.188226 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:30:32.189373 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    s.sale_date,
    p.category,
    sum(s.quantity * p.price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on s.product_id = p.product_id
group by s.sale_date, p.category;
  );
  
[0m16:30:32.192174 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: group by s.sale_date, p.category;
                                         ^

[0m16:30:32.193336 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:30:32.196192 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:30:32.085299 => 16:30:32.195650
[0m16:30:32.197312 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:30:32.204248 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:30:32.205436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c34a5e9a-2985-40e9-bd6f-3072febe2799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B805940>]}
[0m16:30:32.207124 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.14s]
[0m16:30:32.209042 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:30:32.211910 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.211910 [debug] [MainThread]: On master: BEGIN
[0m16:30:32.213658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:32.239900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:32.241584 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.242185 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:32.243337 [debug] [MainThread]: On master: COMMIT
[0m16:30:32.246067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:32.247133 [debug] [MainThread]: On master: Close
[0m16:30:32.249279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:32.250340 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:30:32.251998 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:30:32.253026 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:30:32.254228 [info ] [MainThread]: 
[0m16:30:32.255215 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m16:30:32.258196 [debug] [MainThread]: Command end result
[0m16:30:32.274834 [info ] [MainThread]: 
[0m16:30:32.276430 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:30:32.277708 [info ] [MainThread]: 
[0m16:30:32.280214 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:30:32.282216 [info ] [MainThread]: 
[0m16:30:32.284215 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:30:32.287777 [debug] [MainThread]: Command `dbt run` failed at 16:30:32.286727 after 1.59 seconds
[0m16:30:32.288800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0892C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B1A07F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0B37CA90>]}
[0m16:30:32.290791 [debug] [MainThread]: Flushing usage events
[0m16:33:20.195384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8693C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF89214D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF89214D30>]}


============================== 16:33:20.209460 | 1df8c4d4-9257-4637-8cf4-abb05c104991 ==============================
[0m16:33:20.209460 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:33:20.212219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:33:20.629624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1df8c4d4-9257-4637-8cf4-abb05c104991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF893B0F40>]}
[0m16:33:20.889481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1df8c4d4-9257-4637-8cf4-abb05c104991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8939C940>]}
[0m16:33:20.893482 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:33:20.920780 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:33:21.186824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:21.187824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:21.196825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1df8c4d4-9257-4637-8cf4-abb05c104991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF899260D0>]}
[0m16:33:21.216652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1df8c4d4-9257-4637-8cf4-abb05c104991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8958F7C0>]}
[0m16:33:21.217669 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:33:21.219173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1df8c4d4-9257-4637-8cf4-abb05c104991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8958F940>]}
[0m16:33:21.221516 [info ] [MainThread]: 
[0m16:33:21.223098 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:33:21.226077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:33:21.244087 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:33:21.246087 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:33:21.247087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:21.282636 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:33:21.285906 [debug] [ThreadPool]: On list_postgres: Close
[0m16:33:21.290605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:33:21.304267 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:33:21.305290 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:33:21.306279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:21.342876 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:33:21.344638 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:33:21.345940 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:33:21.353038 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:33:21.355164 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:33:21.359093 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:33:21.370730 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:21.372001 [debug] [MainThread]: On master: BEGIN
[0m16:33:21.373199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:21.401639 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:33:21.403322 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:21.404948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:33:21.413766 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:33:21.417007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1df8c4d4-9257-4637-8cf4-abb05c104991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF894D6850>]}
[0m16:33:21.418054 [debug] [MainThread]: On master: ROLLBACK
[0m16:33:21.421784 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:21.422861 [debug] [MainThread]: On master: BEGIN
[0m16:33:21.427308 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:33:21.429004 [debug] [MainThread]: On master: COMMIT
[0m16:33:21.429542 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:21.431038 [debug] [MainThread]: On master: COMMIT
[0m16:33:21.434117 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:33:21.435400 [debug] [MainThread]: On master: Close
[0m16:33:21.437736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:33:21.439303 [info ] [MainThread]: 
[0m16:33:21.446179 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:21.448608 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:33:21.453551 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:33:21.454551 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:21.480234 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:21.484262 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:33:21.456553 => 16:33:21.483262
[0m16:33:21.486262 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:21.582204 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:21.585918 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:21.586930 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:33:21.588930 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:33:21.619722 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:33:21.620809 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:21.621971 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    s.sale_date,
    p.category,
    sum(s.quantity * p.price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on s.product_id = p.product_id
group by s.sale_date, p.category;
  );
  
[0m16:33:21.624803 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: group by s.sale_date, p.category;
                                         ^

[0m16:33:21.626459 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: ROLLBACK
[0m16:33:21.629336 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:33:21.487260 => 16:33:21.628822
[0m16:33:21.631729 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:33:21.640381 [debug] [Thread-1  ]: Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:33:21.641961 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1df8c4d4-9257-4637-8cf4-abb05c104991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8994CF40>]}
[0m16:33:21.643571 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.19s]
[0m16:33:21.645324 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:21.648378 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:21.649732 [debug] [MainThread]: On master: BEGIN
[0m16:33:21.650277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:21.676543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:33:21.677579 [debug] [MainThread]: On master: COMMIT
[0m16:33:21.678679 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:21.679228 [debug] [MainThread]: On master: COMMIT
[0m16:33:21.681973 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:33:21.683055 [debug] [MainThread]: On master: Close
[0m16:33:21.684678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:21.685771 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:33:21.686854 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:33:21.687953 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:33:21.689289 [info ] [MainThread]: 
[0m16:33:21.690821 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m16:33:21.692844 [debug] [MainThread]: Command end result
[0m16:33:21.709093 [info ] [MainThread]: 
[0m16:33:21.710407 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:33:21.712426 [info ] [MainThread]: 
[0m16:33:21.714087 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models\marts\daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by s.sale_date, p.category;
                                           ^
  compiled Code at target\run\TP_note_DBT\models\marts\daily_sales_revenue_by_category.sql
[0m16:33:21.717094 [info ] [MainThread]: 
[0m16:33:21.718093 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:33:21.721608 [debug] [MainThread]: Command `dbt run` failed at 16:33:21.721608 after 1.72 seconds
[0m16:33:21.722607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8693C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF893F25B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8958FA00>]}
[0m16:33:21.724835 [debug] [MainThread]: Flushing usage events
[0m16:33:33.307306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231CE95B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D1264970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D12543A0>]}


============================== 16:33:33.321356 | 78e0794e-85c1-4ad2-99ec-9b793d029f91 ==============================
[0m16:33:33.321356 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:33:33.324302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models daily_sales_revenue_by_category', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:33.708849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78e0794e-85c1-4ad2-99ec-9b793d029f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D1264130>]}
[0m16:33:33.842330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78e0794e-85c1-4ad2-99ec-9b793d029f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D124B4C0>]}
[0m16:33:33.844378 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:33:33.855602 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:33:33.990358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:33:33.991356 [debug] [MainThread]: Partial parsing: updated file: TP_note_DBT://models\marts\daily_sales_revenue_by_category.sql
[0m16:33:34.180463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78e0794e-85c1-4ad2-99ec-9b793d029f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D1A990D0>]}
[0m16:33:34.199759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78e0794e-85c1-4ad2-99ec-9b793d029f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D15BB760>]}
[0m16:33:34.201720 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:33:34.202738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78e0794e-85c1-4ad2-99ec-9b793d029f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D15BB940>]}
[0m16:33:34.204816 [info ] [MainThread]: 
[0m16:33:34.206905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:33:34.208946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:33:34.224595 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:33:34.225588 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:33:34.226594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:34.260807 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:33:34.263661 [debug] [ThreadPool]: On list_postgres: Close
[0m16:33:34.269812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:33:34.283151 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:33:34.284149 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:33:34.285150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:34.311660 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:33:34.312767 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:33:34.313918 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:33:34.319320 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:33:34.322164 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:33:34.325151 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:33:34.335088 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:34.336235 [debug] [MainThread]: On master: BEGIN
[0m16:33:34.337835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:34.361361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:33:34.362560 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:34.363638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:33:34.371065 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:33:34.374149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78e0794e-85c1-4ad2-99ec-9b793d029f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D14E9A30>]}
[0m16:33:34.375147 [debug] [MainThread]: On master: ROLLBACK
[0m16:33:34.378115 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:34.379499 [debug] [MainThread]: On master: BEGIN
[0m16:33:34.383565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:33:34.384706 [debug] [MainThread]: On master: COMMIT
[0m16:33:34.385273 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:34.386379 [debug] [MainThread]: On master: COMMIT
[0m16:33:34.388876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:33:34.389718 [debug] [MainThread]: On master: Close
[0m16:33:34.391429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:33:34.392478 [info ] [MainThread]: 
[0m16:33:34.398841 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:34.399880 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:33:34.401935 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_revenue_by_category'
[0m16:33:34.402943 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:34.418455 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:34.419416 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (compile): 16:33:34.403953 => 16:33:34.419416
[0m16:33:34.420723 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:34.487452 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:34.490463 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:34.491510 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: BEGIN
[0m16:33:34.492507 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:33:34.519829 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:33:34.520915 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:34.522069 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    s.sale_date,
    p.category,
    sum(s.quantity * p.price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p
    on s.product_id = p.product_id
group by s.sale_date, p.category
  );
  
[0m16:33:34.538290 [debug] [Thread-1  ]: SQL status: SELECT 169 in 0.0 seconds
[0m16:33:34.549564 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:34.550565 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */
alter table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp" rename to "daily_sales_revenue_by_category"
[0m16:33:34.555412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:33:34.582897 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: COMMIT
[0m16:33:34.584453 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:34.585500 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: COMMIT
[0m16:33:34.592486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:33:34.606961 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."daily_sales_revenue_by_category__dbt_backup"
[0m16:33:34.614961 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_revenue_by_category"
[0m16:33:34.615962 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_revenue_by_category"} */
drop table if exists "postgres"."public"."daily_sales_revenue_by_category__dbt_backup" cascade
[0m16:33:34.620618 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:33:34.623457 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_revenue_by_category (execute): 16:33:34.421771 => 16:33:34.622891
[0m16:33:34.624588 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_revenue_by_category: Close
[0m16:33:34.626446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e0794e-85c1-4ad2-99ec-9b793d029f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D1ACCDF0>]}
[0m16:33:34.628296 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.daily_sales_revenue_by_category ....... [[32mSELECT 169[0m in 0.23s]
[0m16:33:34.631195 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_revenue_by_category
[0m16:33:34.634247 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:34.635925 [debug] [MainThread]: On master: BEGIN
[0m16:33:34.637138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:34.664228 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:33:34.665320 [debug] [MainThread]: On master: COMMIT
[0m16:33:34.665949 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:34.667006 [debug] [MainThread]: On master: COMMIT
[0m16:33:34.669282 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:33:34.669851 [debug] [MainThread]: On master: Close
[0m16:33:34.671510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:34.673267 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:33:34.674319 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:33:34.676058 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_revenue_by_category' was properly closed.
[0m16:33:34.677225 [info ] [MainThread]: 
[0m16:33:34.678870 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:33:34.681108 [debug] [MainThread]: Command end result
[0m16:33:34.765719 [info ] [MainThread]: 
[0m16:33:34.768414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:34.769422 [info ] [MainThread]: 
[0m16:33:34.771599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:33:34.776012 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:34.776012 after 1.57 seconds
[0m16:33:34.778419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231CE95B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D1402E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D148F0A0>]}
[0m16:33:34.779422 [debug] [MainThread]: Flushing usage events
[0m16:41:44.930834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B15EC340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B3CD6E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B3CD6070>]}


============================== 16:41:44.939845 | d485e360-73ba-46d3-aed8-08a985c0bbe2 ==============================
[0m16:41:44.939845 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:41:44.942322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select daily_sales_volume', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:45.315280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd485e360-73ba-46d3-aed8-08a985c0bbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B3CEF130>]}
[0m16:41:45.476973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd485e360-73ba-46d3-aed8-08a985c0bbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B3D06070>]}
[0m16:41:45.478974 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:41:45.490800 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:41:45.675579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:45.676560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:45.685589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd485e360-73ba-46d3-aed8-08a985c0bbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B41A60D0>]}
[0m16:41:45.704550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd485e360-73ba-46d3-aed8-08a985c0bbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B403B850>]}
[0m16:41:45.705581 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:41:45.706541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd485e360-73ba-46d3-aed8-08a985c0bbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B403BA30>]}
[0m16:41:45.709154 [info ] [MainThread]: 
[0m16:41:45.711536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:41:45.714307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:41:45.739318 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:41:45.742318 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:41:45.743842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:45.785877 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:41:45.789776 [debug] [ThreadPool]: On list_postgres: Close
[0m16:41:45.796601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:41:45.813307 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:41:45.813883 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:41:45.814898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:45.842368 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:41:45.842991 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:41:45.844110 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:41:45.850105 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:41:45.852949 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:41:45.856304 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:41:45.867561 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:45.868572 [debug] [MainThread]: On master: BEGIN
[0m16:41:45.870619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:45.902348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:41:45.903530 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:45.904713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:41:45.914918 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:41:45.919321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd485e360-73ba-46d3-aed8-08a985c0bbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B3FD2190>]}
[0m16:41:45.920962 [debug] [MainThread]: On master: ROLLBACK
[0m16:41:45.923877 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:45.925937 [debug] [MainThread]: On master: BEGIN
[0m16:41:45.930921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:41:45.932051 [debug] [MainThread]: On master: COMMIT
[0m16:41:45.933133 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:45.934270 [debug] [MainThread]: On master: COMMIT
[0m16:41:45.936991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:41:45.938641 [debug] [MainThread]: On master: Close
[0m16:41:45.941256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:45.944220 [info ] [MainThread]: 
[0m16:41:45.950945 [debug] [Thread-1  ]: Began running node model.TP_note_DBT.daily_sales_volume
[0m16:41:45.952085 [info ] [Thread-1  ]: 1 of 1 START sql table model public.daily_sales_volume ......................... [RUN]
[0m16:41:45.955260 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.TP_note_DBT.daily_sales_volume'
[0m16:41:45.956957 [debug] [Thread-1  ]: Began compiling node model.TP_note_DBT.daily_sales_volume
[0m16:41:45.974405 [debug] [Thread-1  ]: Writing injected SQL for node "model.TP_note_DBT.daily_sales_volume"
[0m16:41:45.977668 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_volume (compile): 16:41:45.958101 => 16:41:45.976415
[0m16:41:45.979422 [debug] [Thread-1  ]: Began executing node model.TP_note_DBT.daily_sales_volume
[0m16:41:46.087011 [debug] [Thread-1  ]: Writing runtime sql for node "model.TP_note_DBT.daily_sales_volume"
[0m16:41:46.089614 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_volume"
[0m16:41:46.091753 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_volume: BEGIN
[0m16:41:46.093159 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:41:46.124465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:41:46.126274 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_volume"
[0m16:41:46.128514 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_volume: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_volume"} */

  
    

  create  table "postgres"."public"."daily_sales_volume__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    count(*) as total_sales
from "postgres"."public"."stg_sales"
group by sale_date
  );
  
[0m16:41:46.137152 [debug] [Thread-1  ]: SQL status: SELECT 90 in 0.0 seconds
[0m16:41:46.154981 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_volume"
[0m16:41:46.156692 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_volume: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_volume"} */
alter table "postgres"."public"."daily_sales_volume__dbt_tmp" rename to "daily_sales_volume"
[0m16:41:46.162009 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:41:46.204828 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_volume: COMMIT
[0m16:41:46.205841 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_volume"
[0m16:41:46.206887 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_volume: COMMIT
[0m16:41:46.212474 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:41:46.225098 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public"."daily_sales_volume__dbt_backup"
[0m16:41:46.236109 [debug] [Thread-1  ]: Using postgres connection "model.TP_note_DBT.daily_sales_volume"
[0m16:41:46.238108 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_volume: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "TP_note_DBT", "target_name": "dev", "node_id": "model.TP_note_DBT.daily_sales_volume"} */
drop table if exists "postgres"."public"."daily_sales_volume__dbt_backup" cascade
[0m16:41:46.242115 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:41:46.246790 [debug] [Thread-1  ]: Timing info for model.TP_note_DBT.daily_sales_volume (execute): 16:41:45.980656 => 16:41:46.246284
[0m16:41:46.248437 [debug] [Thread-1  ]: On model.TP_note_DBT.daily_sales_volume: Close
[0m16:41:46.251154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd485e360-73ba-46d3-aed8-08a985c0bbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B41F9DF0>]}
[0m16:41:46.253906 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.daily_sales_volume .................... [[32mSELECT 90[0m in 0.30s]
[0m16:41:46.256657 [debug] [Thread-1  ]: Finished running node model.TP_note_DBT.daily_sales_volume
[0m16:41:46.259399 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:46.260793 [debug] [MainThread]: On master: BEGIN
[0m16:41:46.261861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:46.289915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:41:46.291097 [debug] [MainThread]: On master: COMMIT
[0m16:41:46.292259 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:46.293363 [debug] [MainThread]: On master: COMMIT
[0m16:41:46.296482 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:41:46.297722 [debug] [MainThread]: On master: Close
[0m16:41:46.299921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:46.300989 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:41:46.303016 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:41:46.304127 [debug] [MainThread]: Connection 'model.TP_note_DBT.daily_sales_volume' was properly closed.
[0m16:41:46.305223 [info ] [MainThread]: 
[0m16:41:46.307485 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:41:46.310206 [debug] [MainThread]: Command end result
[0m16:41:46.330034 [info ] [MainThread]: 
[0m16:41:46.332037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:46.334037 [info ] [MainThread]: 
[0m16:41:46.336461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:41:46.340553 [debug] [MainThread]: Command `dbt run` succeeded at 16:41:46.340044 after 1.54 seconds
[0m16:41:46.341760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B15EC340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B3F09B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5B3F805E0>]}
[0m16:41:46.343180 [debug] [MainThread]: Flushing usage events
[0m16:42:06.836823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D0CEC0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D31D4D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D31D4D30>]}


============================== 16:42:06.850820 | 53ebcfe4-d3c1-49e2-9a5b-de5c8478fa96 ==============================
[0m16:42:06.850820 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:42:06.853839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\cleme\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\cleme\\TP_note_DBT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select daily_sales_revenue_by_cetegory', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:42:07.250823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53ebcfe4-d3c1-49e2-9a5b-de5c8478fa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D355FF40>]}
[0m16:42:07.408116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53ebcfe4-d3c1-49e2-9a5b-de5c8478fa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D354B940>]}
[0m16:42:07.411119 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:42:07.433724 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:42:07.633521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:07.634520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:07.643522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53ebcfe4-d3c1-49e2-9a5b-de5c8478fa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D3AA60D0>]}
[0m16:42:07.661485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53ebcfe4-d3c1-49e2-9a5b-de5c8478fa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D373B7C0>]}
[0m16:42:07.663528 [info ] [MainThread]: Found 6 models, 2 seeds, 8 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:42:07.664805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ebcfe4-d3c1-49e2-9a5b-de5c8478fa96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D373B940>]}
[0m16:42:07.665819 [warn ] [MainThread]: The selection criterion 'daily_sales_revenue_by_cetegory' does not match any nodes
[0m16:42:07.668401 [info ] [MainThread]: 
[0m16:42:07.670359 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:42:07.672360 [debug] [MainThread]: Command end result
[0m16:42:07.690242 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:07.690242 after 0.99 seconds
[0m16:42:07.690242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D0CEC0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D3A6ACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6D355FF40>]}
[0m16:42:07.692766 [debug] [MainThread]: Flushing usage events
